<!DOCTYPE html>
<html lang="en-us" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.124.1">
    <meta name="generator" content="Relearn 5.26.2">
    <meta name="description" content="">
    <meta name="author" content="Michael Reitmeir">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="DOOM Emacs Config :: reitis Punktdateien">
    <meta name="twitter:description" content="About this Config Here is some help from the default config.el that I haven&rsquo;t found a better spot for yet.
Here are some additional functions/macros that could help you configure Doom:
`load!&rsquo; for loading external *.el files relative to this one `use-package!&rsquo; for configuring packages `after!&rsquo; for running code after a package has loaded `add-load-path!&rsquo; for adding directories to the `load-path&rsquo;, relative to this file. Emacs searches the `load-path&rsquo; when you load packages with `require&rsquo; or `use-package&#39;.">
    <meta property="og:title" content="DOOM Emacs Config :: reitis Punktdateien">
    <meta property="og:description" content="About this Config Here is some help from the default config.el that I haven&rsquo;t found a better spot for yet.
Here are some additional functions/macros that could help you configure Doom:
`load!&rsquo; for loading external *.el files relative to this one `use-package!&rsquo; for configuring packages `after!&rsquo; for running code after a package has loaded `add-load-path!&rsquo; for adding directories to the `load-path&rsquo;, relative to this file. Emacs searches the `load-path&rsquo; when you load packages with `require&rsquo; or `use-package&#39;.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://freakybyte.github.io/dotfiles/emacs/index.html">
    <meta property="article:section" content="reitis Punktdateien">
    <meta property="og:site_name" content="reitis Punktdateien">
    <title>DOOM Emacs Config :: reitis Punktdateien</title>
    <link href="https://freakybyte.github.io/dotfiles/images/logo.png?1712182173" rel="icon" type="image/png">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://freakybyte.github.io/dotfiles/css/fontawesome-all.min.css?1712182173" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://freakybyte.github.io/dotfiles/css/fontawesome-all.min.css?1712182173" rel="stylesheet"></noscript>
    <link href="https://freakybyte.github.io/dotfiles/css/nucleus.css?1712182173" rel="stylesheet">
    <link href="https://freakybyte.github.io/dotfiles/css/auto-complete.css?1712182173" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://freakybyte.github.io/dotfiles/css/auto-complete.css?1712182173" rel="stylesheet"></noscript>
    <link href="https://freakybyte.github.io/dotfiles/css/perfect-scrollbar.min.css?1712182173" rel="stylesheet">
    <link href="https://freakybyte.github.io/dotfiles/css/fonts.css?1712182173" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://freakybyte.github.io/dotfiles/css/fonts.css?1712182173" rel="stylesheet"></noscript>
    <link href="https://freakybyte.github.io/dotfiles/css/theme.css?1712182173" rel="stylesheet">
    <link href="https://freakybyte.github.io/dotfiles/css/theme-my-custom-variant.css?1712182173" rel="stylesheet" id="R-variant-style">
    <link href="https://freakybyte.github.io/dotfiles/css/chroma-doom-one.css?1712182173" rel="stylesheet" id="R-variant-chroma-style">
    <link href="https://freakybyte.github.io/dotfiles/css/variant.css?1712182173" rel="stylesheet">
    <link href="https://freakybyte.github.io/dotfiles/css/print.css?1712182173" rel="stylesheet" media="print">
    <link href="https://freakybyte.github.io/dotfiles/css/ie.css?1712182173" rel="stylesheet">
    <script src="https://freakybyte.github.io/dotfiles/js/url.js?1712182173"></script>
    <script src="https://freakybyte.github.io/dotfiles/js/variant.js?1712182173"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..';
      window.relearn.relBaseUri='..';
      window.relearn.absBaseUri='https:\/\/freakybyte.github.io\/dotfiles';
      // variant stuff
      window.relearn.themeVariantModifier='';
      window.variants && variants.init( [ 'my-custom-variant' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="https://freakybyte.github.io/dotfiles/emacs/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"><nav class="TableOfContents">
  <ul>
    <li><a href="#about-this-config">About this Config</a></li>
    <li><a href="#basics">Basics</a>
      <ul>
        <li><a href="#sensible-defaults">Sensible Defaults</a></li>
        <li><a href="#emacs-everywhere">Emacs EVERYWHERE</a></li>
      </ul>
    </li>
    <li><a href="#appearance">Appearance</a>
      <ul>
        <li><a href="#fonts">Fonts</a></li>
        <li><a href="#theme">Theme</a></li>
        <li><a href="#modeline">Modeline</a></li>
        <li><a href="#dashboard--startup-page">Dashboard (startup page)</a></li>
        <li><a href="#line-numbers-and-wrapping">Line Numbers and Wrapping</a></li>
        <li><a href="#transparent-background">Transparent Background</a></li>
        <li><a href="#whitespace">Whitespace</a></li>
        <li><a href="#treemacs">Treemacs</a></li>
      </ul>
    </li>
    <li><a href="#global-functionality">Global Functionality</a>
      <ul>
        <li><a href="#local-leader">Local Leader</a></li>
        <li><a href="#move-cut">Move/Cut</a></li>
        <li><a href="#windows-and-buffers">Windows and Buffers</a></li>
        <li><a href="#auto-complete">Auto-complete</a></li>
        <li><a href="#spell-and-grammar-checker">Spell- and grammar checker</a></li>
        <li><a href="#snippets">Snippets</a></li>
        <li><a href="#zen-writeroom">Zen/Writeroom</a></li>
      </ul>
    </li>
    <li><a href="#org-mode">Org Mode</a>
      <ul>
        <li><a href="#org-paths">Org-Paths</a></li>
        <li><a href="#org-appearance">Org Appearance</a></li>
        <li><a href="#org-roam">Org Roam</a></li>
        <li><a href="#org-latex-previews">Org LaTeX previews</a></li>
        <li><a href="#xournal-plus-plus-integration--org-notebook">Xournal++ integration (&ldquo;Org Notebook&rdquo;)</a></li>
        <li><a href="#org-d20">org-d20</a></li>
      </ul>
    </li>
    <li><a href="#latex">LaTeX</a>
      <ul>
        <li><a href="#fixing-defaults">&ldquo;Fixing&rdquo; defaults</a></li>
        <li><a href="#appearance">Appearance</a></li>
        <li><a href="#cdlatex">CDLaTeX</a></li>
      </ul>
    </li>
    <li><a href="#tangle-this-file">Tangle this file!</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="https://freakybyte.github.io/dotfiles/index.html"><span itemprop="name">reitis Punktdateien</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">DOOM Emacs Config</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="https://freakybyte.github.io/dotfiles/index.html" title="reitis Punktdateien (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="https://freakybyte.github.io/dotfiles/qtile/index.html" title="Qtile Config (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="doom-emacs-config">DOOM Emacs Config</h1>

<h2 id="about-this-config">About this Config</h2>
<p>Here is some help from the default config.el that I haven&rsquo;t found a better spot for yet.</p>
<blockquote>
<p>Here are some additional functions/macros that could help you configure Doom:</p>
<ul>
<li>`load!&rsquo; for loading external *.el files relative to this one</li>
<li>`use-package!&rsquo; for configuring packages</li>
<li>`after!&rsquo; for running code after a package has loaded</li>
<li>`add-load-path!&rsquo; for adding directories to the `load-path&rsquo;, relative to
this file. Emacs searches the `load-path&rsquo; when you load packages with
`require&rsquo; or `use-package'.</li>
<li>`map!&rsquo; for binding new keys</li>
</ul>
<p>To get information about any of these functions/macros, move the cursor over
the highlighted symbol at press &lsquo;K&rsquo; (non-evil users must press &lsquo;C-c c k&rsquo;).
This will open documentation for it, including demos of how they are used.</p>
<p>You can also try &lsquo;gd&rsquo; (or &lsquo;C-c c d&rsquo;) to jump to their definition and see how
they are implemented.</p>
</blockquote>
<h2 id="basics">Basics</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;; $DOOMDIR/config.el -*- lexical-binding: t; -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#00b1f7">user-full-name</span> <span style="color:#98c379">&#34;Michael Reitmeir&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">user-mail-address</span> <span style="color:#98c379">&#34;michi.reitmeir@gmail.com&#34;</span>)</span></span></code></pre></div><h3 id="sensible-defaults">Sensible Defaults</h3>
<p>Inspired by <a href="https://tecosaur.github.io/emacs-config/config.html#better-defaults" target="_blank">tecosaur</a>, who was in turn inspired by others. Funny how that works.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq-default</span>
</span></span><span style="display:flex;"><span> <span style="color:#dcaeea">delete-by-moving-to-trash</span> <span style="color:#b756ff;font-weight:bold">t</span>                      <span style="color:#8a93a5;font-style:italic">; Delete files to trash</span>
</span></span><span style="display:flex;"><span> <span style="color:#dcaeea">window-combination-resize</span> <span style="color:#b756ff;font-weight:bold">t</span>                      <span style="color:#8a93a5;font-style:italic">; take new window space from all other windows (not just current)</span>
</span></span><span style="display:flex;"><span> <span style="color:#dcaeea">x-stretch-cursor</span> <span style="color:#b756ff;font-weight:bold">t</span>)                              <span style="color:#8a93a5;font-style:italic">; Stretch cursor to the glyph width</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">undo-limit</span> <span style="color:#d19a66">80000000</span>                         <span style="color:#8a93a5;font-style:italic">; Raise undo-limit to 80Mb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">evil-want-fine-undo</span> <span style="color:#b756ff;font-weight:bold">t</span>                       <span style="color:#8a93a5;font-style:italic">; By default while in insert all changes are one big blob. Be more granular</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">auto-save-default</span> <span style="color:#b756ff;font-weight:bold">t</span>                         <span style="color:#8a93a5;font-style:italic">; Nobody likes to loose work, I certainly don&#39;t</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">truncate-string-ellipsis</span> <span style="color:#98c379">&#34;…&#34;</span>)</span></span></code></pre></div><p>Tecosaur finds it handy to be asked which buffer to see after splitting a window. So do I.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;; first, enter the new window</span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">evil-vsplit-window-right</span> <span style="color:#b756ff;font-weight:bold">t</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">evil-split-window-below</span> <span style="color:#b756ff;font-weight:bold">t</span>)
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;; then, pull up buffer prompt</span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">defadvice!</span> <span style="color:#dcaeea">prompt-for-buffer</span> (<span style="color:#c678dd">&amp;rest</span> <span style="color:#dcaeea">_</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#ef8383">:after</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">evil-window-split</span> <span style="color:#dcaeea">evil-window-vsplit</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">consult-buffer</span>))</span></span></code></pre></div><p>The <a href="https://fishshell.com/" target="_blank">fish</a> shell is not <a href="https://stackoverflow.com/questions/48732986/why-how-fish-does-not-support-posix" target="_blank">POSIX compatible</a>, which among other things causes a bunch of garbage characters to appear whenever it is used in emacs (at least with my fish config). So it&rsquo;s better to have emacs use bash instead, especially in the interest of packages that rely on shell outputs</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">shell-file-name</span> (<span style="color:#dcaeea">executable-find</span> <span style="color:#98c379">&#34;bash&#34;</span>))</span></span></code></pre></div><h3 id="emacs-everywhere">Emacs EVERYWHERE</h3>
<p>This changes the name of windows created with <code>emacs-everwhere</code>, so that I can more easily customize their behaviour in my window manager.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">emacs-everywhere-frame-name-format</span> <span style="color:#98c379">&#34;emacs-everywhere&#34;</span>)</span></span></code></pre></div><p>Specifically, I want my window manager to handle it&rsquo;s position rather than emacs.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">remove-hook</span> <span style="color:#56b6c2">&#39;emacs-everywhere-init-hooks</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">emacs-everywhere-set-frame-position</span>)</span></span></code></pre></div><p>Org mode is nice.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">emacs-everywhere-major-mode-function</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-mode</span>)</span></span></code></pre></div><h2 id="appearance">Appearance</h2>
<h3 id="fonts">Fonts</h3>
<p>From the default config.el:</p>
<blockquote>
<p>Doom exposes five (optional) variables for controlling fonts in Doom. Here
are the three important ones:</p>
<ul>
<li>`doom-font&rsquo;</li>
<li>`doom-variable-pitch-font&rsquo;</li>
<li>`doom-big-font&rsquo; &ndash; used for `doom-big-font-mode&rsquo;; use this for
presentations or streaming.</li>
</ul>
<p>They all accept either a font-spec, font string (&ldquo;Input Mono-12&rdquo;), or xlfd
font string. You generally only need these two:
(setq doom-font (font-spec :family &ldquo;monospace&rdquo; :size 12 :weight &lsquo;semi-light)
doom-variable-pitch-font (font-spec :family &ldquo;sans&rdquo; :size 13))</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">doom-font</span> (<span style="color:#00b1f7">font-spec</span> <span style="color:#ef8383">:family</span> <span style="color:#98c379">&#34;JetBrains Mono&#34;</span> <span style="color:#ef8383">:size</span> <span style="color:#d19a66">15</span> <span style="color:#ef8383">:weight</span> <span style="color:#56b6c2">&#39;regular</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">doom-variable-pitch-font</span> (<span style="color:#00b1f7">font-spec</span> <span style="color:#ef8383">:family</span> <span style="color:#98c379">&#34;Libertinus Sans&#34;</span> <span style="color:#ef8383">:size</span> <span style="color:#d19a66">19</span>))
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;      doom-variable-pitch-font (font-spec :family &#34;Fira Sans&#34;) ; inherits `doom-font&#39;&#39;s :size</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;      doom-unicode-font (font-spec :family &#34;Input Mono Narrow&#34; :size 12)</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;      doom-big-font (font-spec :family &#34;Fira Mono&#34; :size 19))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq-default</span> <span style="color:#dcaeea">line-spacing</span> <span style="color:#d19a66">0.25</span>)</span></span></code></pre></div><p>I also gotta activate <code>mixed-pitch-set-height</code>, so that <code>mixed-pitch-mode</code> actually uses the <code>:size</code> option from the variable pitch font above.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">mixed-pitch-set-height</span> <span style="color:#b756ff;font-weight:bold">t</span>)</span></span></code></pre></div><p>Let&rsquo;s bind some keys for quick toggling between the different font modes.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:leader</span>
</span></span><span style="display:flex;"><span> (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;t&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;toggle&#34;</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Mixed pitch mode&#34;</span>       <span style="color:#98c379">&#34;m&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">mixed-pitch-mode</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Variable pitch mode&#34;</span>    <span style="color:#98c379">&#34;v&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">variable-pitch-mode</span>
</span></span><span style="display:flex;"><span>       )
</span></span><span style="display:flex;"><span>      )</span></span></code></pre></div><p>By this, <code>visible-mode</code> has been unmapped from <code>SPC t v</code>. Let&rsquo;s remap it to <code>SPC t V</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:leader</span>
</span></span><span style="display:flex;"><span> (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;t&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;toggle&#34;</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Visible mode&#34;</span>           <span style="color:#98c379">&#34;V&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">visible-mode</span>
</span></span><span style="display:flex;"><span>       )
</span></span><span style="display:flex;"><span>      )</span></span></code></pre></div><h3 id="theme">Theme</h3>
<p>I like DOOMs default colors</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">doom-theme</span> <span style="color:#56b6c2">&#39;doom-one</span>)</span></span></code></pre></div><p>But I still wanna customize it a bit.</p>
<h4 id="shades-with-ewal">Shades with ewal</h4>
<p>I use <a href="https://github.com/dylanaraps/pywal" target="_blank">pywal</a> to have the colors in my terminal fit my wallpaper.
While for Emacs I use the colors from the <code>doom-one</code> theme, I still want the (transparent) backgrounds of different parts of Emacs to synergyze with pywal.
For this, the <a href="https://github.com/cyruseuros/ewal" target="_blank">ewal</a> package is used to get the colorscheme from pywal into Emacs.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">use-package</span> <span style="color:#dcaeea">ewal</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">use-package</span> <span style="color:#dcaeea">ewal-doom-themes</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">doom-themes</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#dcaeea">custom-theme-set-faces!</span> <span style="color:#dcaeea">doom-theme</span>
</span></span><span style="display:flex;"><span>          <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">default</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>))
</span></span><span style="display:flex;"><span>          <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">seperator-line</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>))
</span></span><span style="display:flex;"><span>          <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">hl-line</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.1</span>))
</span></span><span style="display:flex;"><span>          <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">org-block</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                      (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">-0.3</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; Tabs:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">tab-bar</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">centaur-tabs-selected</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.1</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">tab-bar-tab</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.1</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">centaur-tabs-unselected</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.05</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">tab-bar-tab-inactive</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.05</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">tab-line</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; Mode line:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">mode-line</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.15</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">mode-line-inactive</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.05</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">mode-line-emphasis</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal--color-chshade</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>) <span style="color:#d19a66">.20</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; minibuffer (underneath mode line) and stuff</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">solaire-default-face</span> <span style="color:#ef8383">:background</span> <span style="color:#c7bf54">,</span>(<span style="color:#dcaeea">ewal-load-color</span> <span style="color:#56b6c2">&#39;background</span>))
</span></span><span style="display:flex;"><span>        ))</span></span></code></pre></div><h3 id="modeline">Modeline</h3>
<p>Making the modeline a bit taller than the default height (25) seems nice.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">doom-modeline-height</span> <span style="color:#d19a66">35</span>)</span></span></code></pre></div><h3 id="dashboard--startup-page">Dashboard (startup page)</h3>
<p>I the silly banner I found at <a href="https://github.com/jeetelongname/doom-banners" target="_blank">https://github.com/jeetelongname/doom-banners</a> for my dashboard. To fit with this, font color is changed to pink.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">doom-themes</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">custom-theme-set-faces!</span> <span style="color:#56b6c2">&#39;doom-one</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">doom-dashboard-banner</span> <span style="color:#ef8383">:foreground</span> <span style="color:#98c379">&#34;pink&#34;</span> <span style="color:#ef8383">:weight</span> <span style="color:#dcaeea">bold</span>)
</span></span><span style="display:flex;"><span>        ))
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">fancy-splash-image</span> <span style="color:#98c379">&#34;~/.config/doom/I-am-doom.png&#34;</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">+doom-dashboard-banner-padding</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#d19a66">0</span> <span style="color:#c7bf54">.</span> <span style="color:#d19a66">0</span>))</span></span></code></pre></div><p>The change in padding is to remove the whitespace after the splash image, so that everything still fits on the screen (for the most part).</p>
<h3 id="line-numbers-and-wrapping">Line Numbers and Wrapping</h3>
<p>Display relative line numbers, but do so counting lines as displayed, not actual line breaks in the buffer.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">display-line-numbers-type</span> <span style="color:#56b6c2">&#39;visual</span>)</span></span></code></pre></div><p>This works well for me, because I like overlength lines to always automatically wrap.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">global-visual-line-mode</span> <span style="color:#b756ff;font-weight:bold">t</span>)</span></span></code></pre></div><p>Maximum line length (when <code>window-margin-mode</code> is active)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq-default</span> <span style="color:#dcaeea">fill-column</span> <span style="color:#d19a66">100</span>)</span></span></code></pre></div><h3 id="transparent-background">Transparent Background</h3>
<p>I like me some transparent backgrounds. This value controls the opacity if transparent background is enabled.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defconst</span> <span style="color:#dcaeea">doom-frame-transparency</span> <span style="color:#d19a66">85</span>)</span></span></code></pre></div><p>In contrast, the variable <code>doom-frame-opacity</code> is used for the current opacity. So this variable is set to <code>100</code> if transparency is disabled.</p>
<p>Now follows a function to toggle the transparent background on and off.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">toggle-background-opacity</span> ()
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;toggle transparent background&#34;</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">if</span> (<span style="color:#00b1f7">eq</span> <span style="color:#dcaeea">doom-frame-opacity</span> <span style="color:#d19a66">100</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">doom-frame-opacity</span> <span style="color:#dcaeea">doom-frame-transparency</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">doom-frame-opacity</span> <span style="color:#d19a66">100</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#dcaeea">set-frame-parameter</span> (<span style="color:#00b1f7">selected-frame</span>) <span style="color:#56b6c2">&#39;alpha</span> <span style="color:#dcaeea">doom-frame-opacity</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#dcaeea">add-to-list</span> <span style="color:#56b6c2">&#39;default-frame-alist</span> <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">alpha</span> <span style="color:#c7bf54">.</span> <span style="color:#c7bf54">,</span><span style="color:#dcaeea">doom-frame-opacity</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">dwc-smart-transparent-frame</span> ()
</span></span><span style="display:flex;"><span>        (<span style="color:#dcaeea">set-frame-parameter</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#00b1f7">selected-frame</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#56b6c2">&#39;alpha</span> (<span style="color:#ef8383">if</span> (<span style="color:#00b1f7">frame-parameter</span> (<span style="color:#00b1f7">selected-frame</span>) <span style="color:#56b6c2">&#39;fullscreen</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#d19a66">100</span>
</span></span><span style="display:flex;"><span>                <span style="color:#dcaeea">doom-frame-opacity</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:leader</span>
</span></span><span style="display:flex;"><span> (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;t&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;toggle&#34;</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;transparency&#34;</span>          <span style="color:#98c379">&#34;t&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">toggle-background-opacity</span>
</span></span><span style="display:flex;"><span>       )
</span></span><span style="display:flex;"><span>      )</span></span></code></pre></div><p>This will make the background transparent at startup.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">doom-frame-opacity</span> <span style="color:#d19a66">100</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">toggle-background-opacity</span>)</span></span></code></pre></div><h3 id="whitespace">Whitespace</h3>
<p>Highlight unnecessary or wrong use of whitespace (e.g. mixed tabs and spaces).</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">use-package!</span> <span style="color:#dcaeea">whitespace</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ef8383">:config</span> (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">whitespace-style</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">face</span> <span style="color:#dcaeea">empty</span> <span style="color:#dcaeea">indentation</span> <span style="color:#dcaeea">space-after-tab</span> <span style="color:#dcaeea">space-before-tab</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">global-whitespace-mode</span> <span style="color:#d19a66">+1</span>))</span></span></code></pre></div><p>Trailing whitespace doesn&rsquo;t need to be visualized, since it&rsquo;s removed on save anyway.</p>
<h3 id="treemacs">Treemacs</h3>
<p>By default, the treemacs window is not re-sizable. I don&rsquo;t see why.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">treemacs-width</span> <span style="color:#d19a66">30</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">treemacs--width-is-locked</span> <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">treemacs-width-is-initially-locked</span> <span style="color:#b756ff;font-weight:bold">nil</span>)</span></span></code></pre></div><p>Especially when using LaTeX, there&rsquo;s gonna be a lot of files in my directory which I don&rsquo;t actively care about. The following hides these files. (cf. <a href="https://tecosaur.github.io/emacs-config/config.html#treemacs" target="_blank">tecosaur</a>)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">treemacs</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">defvar</span> <span style="color:#dcaeea">treemacs-file-ignore-extensions</span> <span style="color:#c7bf54">&#39;</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;File extension which </span><span style="color:#56b6c2">`treemacs-ignore-filter&#39;</span><span style="color:#98c379"> will ensure are ignored&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">defvar</span> <span style="color:#dcaeea">treemacs-file-ignore-globs</span> <span style="color:#c7bf54">&#39;</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;Globs which will are transformed to </span><span style="color:#56b6c2">`treemacs-file-ignore-regexps&#39;</span><span style="color:#98c379"> which </span><span style="color:#56b6c2">`treemacs-ignore-filter&#39;</span><span style="color:#98c379"> will ensure are ignored&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">defvar</span> <span style="color:#dcaeea">treemacs-file-ignore-regexps</span> <span style="color:#c7bf54">&#39;</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;RegExps to be tested to ignore files, generated from </span><span style="color:#56b6c2">`treeemacs-file-ignore-globs&#39;</span><span style="color:#98c379">&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">treemacs-file-ignore-generate-regexps</span> ()
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;Generate </span><span style="color:#56b6c2">`treemacs-file-ignore-regexps&#39;</span><span style="color:#98c379"> from </span><span style="color:#56b6c2">`treemacs-file-ignore-globs&#39;</span><span style="color:#98c379">&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">treemacs-file-ignore-regexps</span> (<span style="color:#00b1f7">mapcar</span> <span style="color:#56b6c2">&#39;dired-glob-regexp</span> <span style="color:#dcaeea">treemacs-file-ignore-globs</span>)))
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">if</span> (<span style="color:#00b1f7">equal</span> <span style="color:#dcaeea">treemacs-file-ignore-globs</span> <span style="color:#c7bf54">&#39;</span>()) <span style="color:#b756ff;font-weight:bold">nil</span> (<span style="color:#dcaeea">treemacs-file-ignore-generate-regexps</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">treemacs-ignore-filter</span> (<span style="color:#dcaeea">file</span> <span style="color:#dcaeea">full-path</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;Ignore files specified by </span><span style="color:#56b6c2">`treemacs-file-ignore-extensions&#39;</span><span style="color:#98c379">, and </span><span style="color:#56b6c2">`treemacs-file-ignore-regexps&#39;</span><span style="color:#98c379">&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">or</span> (<span style="color:#00b1f7">member</span> (<span style="color:#dcaeea">file-name-extension</span> <span style="color:#dcaeea">file</span>) <span style="color:#dcaeea">treemacs-file-ignore-extensions</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">ignore-file</span> <span style="color:#b756ff;font-weight:bold">nil</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#ef8383">dolist</span> (<span style="color:#dcaeea">regexp</span> <span style="color:#dcaeea">treemacs-file-ignore-regexps</span> <span style="color:#dcaeea">ignore-file</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">ignore-file</span> (<span style="color:#ef8383">or</span> <span style="color:#dcaeea">ignore-file</span> (<span style="color:#ef8383">if</span> (<span style="color:#dcaeea">string-match-p</span> <span style="color:#dcaeea">regexp</span> <span style="color:#dcaeea">full-path</span>) <span style="color:#b756ff;font-weight:bold">t</span> <span style="color:#b756ff;font-weight:bold">nil</span>)))))))
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">add-to-list</span> <span style="color:#56b6c2">&#39;treemacs-ignored-file-predicates</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">treemacs-ignore-filter</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">treemacs-file-ignore-extensions</span>
</span></span><span style="display:flex;"><span>      <span style="color:#c7bf54">&#39;</span>(<span style="color:#8a93a5;font-style:italic">;; LaTeX</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;aux&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;ptc&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;fdb_latexmk&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;fls&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;synctex.gz&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;gz&#34;</span> <span style="color:#8a93a5;font-style:italic">; the function actually recognizes the last &#39;.&#39;, not the first; I don&#39;t think I&#39;ll ever need to look at .gz-files anyways</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;toc&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; LaTeX - glossary</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;glg&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;glo&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;gls&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;glsdefs&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;ist&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;acn&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;acr&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;alg&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; LaTeX - pgfplots</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;mw&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; LaTeX - pdfx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;pdfa.xmpi&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; further LaTeX stuff</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;bbl&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;bcf&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;blg&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;nav&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;out&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;snm&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;vrb&#34;</span>
</span></span><span style="display:flex;"><span>        ))
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">treemacs-file-ignore-globs</span>
</span></span><span style="display:flex;"><span>      <span style="color:#c7bf54">&#39;</span>(<span style="color:#8a93a5;font-style:italic">;; LaTeX</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;*/_minted-*&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; AucTeX</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;*/.auctex-auto&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;*/_region_.log&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;*/_region_.tex&#34;</span>))</span></span></code></pre></div><h2 id="global-functionality">Global Functionality</h2>
<h3 id="local-leader">Local Leader</h3>
<p>I&rsquo;m used to this from my VimTex days.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">doom-localleader-key</span> <span style="color:#98c379">&#34;,&#34;</span>)</span></span></code></pre></div><h3 id="move-cut">Move/Cut</h3>
<p>I&rsquo;ve always liked that the delete command in vim automatically yanks the deleted text, i.e. it acts more like cutting than deleting.
For this reason I&rsquo;ve configured &rsquo;d&rsquo; and &lsquo;x&rsquo; to not yank the deleted text, and instead defined &rsquo;m&rsquo; (for &ldquo;move&rdquo;, because &lsquo;c&rsquo; is already taken) to delete and yank, i.e. cut.</p>
<p>First we clone the default <code>evil-delete</code> function under the name <code>evil-cut</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">wrapped-copy</span> (<span style="color:#00b1f7">symbol-function</span> <span style="color:#56b6c2">&#39;evil-delete</span>))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">evil-define-operator</span> <span style="color:#dcaeea">evil-cut</span> (<span style="color:#dcaeea">BEG</span> <span style="color:#dcaeea">END</span> <span style="color:#dcaeea">TYPE</span> <span style="color:#dcaeea">REGISTER</span> <span style="color:#dcaeea">YANK-HANDLER</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Cut text from BEG to END with TYPE.
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">Save in REGISTER or in the kill-ring with YANK-HANDLER.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span> <span style="color:#98c379">&#34;&lt;R&gt;&lt;x&gt;&lt;y&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#00b1f7">funcall</span> <span style="color:#dcaeea">wrapped-copy</span> <span style="color:#dcaeea">BEG</span> <span style="color:#dcaeea">END</span> <span style="color:#dcaeea">TYPE</span> <span style="color:#dcaeea">REGISTER</span> <span style="color:#dcaeea">YANK-HANDLER</span>))</span></span></code></pre></div><p>Now we map <code>evil-cut</code> to &rsquo;m&rsquo;.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:n</span> <span style="color:#98c379">&#34;m&#34;</span> <span style="color:#56b6c2">&#39;evil-cut</span>)</span></span></code></pre></div><p>Finally, we automatically redirect all deletions to the black hole register, thus making &rsquo;d&rsquo;, &lsquo;x&rsquo;, and pasting over something only delete and not copy.
We also need to do it for <code>evil-org-delete-char</code>, since that has different input arguments and an extra <code>evil-yank</code> in it&rsquo;s definition for some reason.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">bb/evil-delete</span> (<span style="color:#dcaeea">orig-fn</span> <span style="color:#dcaeea">beg</span> <span style="color:#dcaeea">end</span> <span style="color:#c678dd">&amp;optional</span> <span style="color:#dcaeea">type</span> <span style="color:#dcaeea">_</span> <span style="color:#c678dd">&amp;rest</span> <span style="color:#dcaeea">args</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#00b1f7">apply</span> <span style="color:#dcaeea">orig-fn</span> <span style="color:#dcaeea">beg</span> <span style="color:#dcaeea">end</span> <span style="color:#dcaeea">type</span> <span style="color:#98c379">?_</span> <span style="color:#dcaeea">args</span>))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">advice-add</span> <span style="color:#56b6c2">&#39;evil-delete</span> <span style="color:#ef8383">:around</span> <span style="color:#56b6c2">&#39;bb/evil-delete</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">advice-add</span> <span style="color:#56b6c2">&#39;evil-delete-char</span> <span style="color:#ef8383">:around</span> <span style="color:#56b6c2">&#39;bb/evil-delete</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">bb/evil-org-delete-char</span> (<span style="color:#dcaeea">orig-fn</span> <span style="color:#dcaeea">count</span> <span style="color:#dcaeea">beg</span> <span style="color:#dcaeea">end</span> <span style="color:#c678dd">&amp;optional</span> <span style="color:#dcaeea">type</span> <span style="color:#dcaeea">_</span> <span style="color:#c678dd">&amp;rest</span> <span style="color:#dcaeea">args</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#00b1f7">apply</span> <span style="color:#dcaeea">orig-fn</span> <span style="color:#dcaeea">count</span> <span style="color:#dcaeea">beg</span> <span style="color:#dcaeea">end</span> <span style="color:#dcaeea">type</span> <span style="color:#98c379">?_</span> <span style="color:#dcaeea">args</span>))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">advice-add</span> <span style="color:#56b6c2">&#39;evil-org-delete-char</span> <span style="color:#ef8383">:around</span> <span style="color:#56b6c2">&#39;bb/evil-org-delete-char</span>)</span></span></code></pre></div><h3 id="windows-and-buffers">Windows and Buffers</h3>
<p>A key chord every time I want to switch windows or buffers is way too much work.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:n</span> <span style="color:#98c379">&#34;ö&#34;</span> <span style="color:#56b6c2">&#39;evil-next-buffer</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:n</span> <span style="color:#98c379">&#34;Ö&#34;</span> <span style="color:#56b6c2">&#39;evil-prev-buffer</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:n</span> <span style="color:#98c379">&#34;ä&#34;</span> <span style="color:#56b6c2">&#39;evil-window-next</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:n</span> <span style="color:#98c379">&#34;Ä&#34;</span> <span style="color:#56b6c2">&#39;evil-window-prev</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:n</span> <span style="color:#98c379">&#34;C-ä&#34;</span> <span style="color:#56b6c2">&#39;+evil/window-vsplit-and-follow</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:n</span> <span style="color:#98c379">&#34;C-Ä&#34;</span> <span style="color:#56b6c2">&#39;+evil/window-split-and-follow</span>)</span></span></code></pre></div><h3 id="auto-complete">Auto-complete</h3>
<p>Increase time until auto-complete shows up.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">company-idle-delay</span> <span style="color:#d19a66">0.4</span>)</span></span></code></pre></div><h3 id="spell-and-grammar-checker">Spell- and grammar checker</h3>
<p>These are the dictionaries I want to use for spell checking.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;spell-fu-mode-hook</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">lambda</span> ()
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">spell-fu-dictionary-add</span> (<span style="color:#dcaeea">spell-fu-get-ispell-dictionary</span> <span style="color:#98c379">&#34;de&#34;</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">spell-fu-dictionary-add</span> (<span style="color:#dcaeea">spell-fu-get-ispell-dictionary</span> <span style="color:#98c379">&#34;en&#34;</span>))
</span></span><span style="display:flex;"><span>    ))
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">ispell-personal-dictionary</span> <span style="color:#98c379">&#34;~/Dropbox/.aspell.en.pws&#34;</span>)</span></span></code></pre></div><p>Set path to languagetool.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">langtool-java-classpath</span> <span style="color:#98c379">&#34;/usr/share/languagetool/*&#34;</span>)</span></span></code></pre></div><h3 id="snippets">Snippets</h3>
<p>This disables the annoying final newline when creating a snippet, which always screws things up.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;snippet-mode-hook</span> <span style="color:#56b6c2">&#39;my-snippet-mode-hook</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">my-snippet-mode-hook</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Custom behaviours for </span><span style="color:#56b6c2">`snippet-mode&#39;</span><span style="color:#98c379">.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq-local</span> <span style="color:#dcaeea">require-final-newline</span> <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq-local</span> <span style="color:#dcaeea">mode-require-final-newline</span> <span style="color:#b756ff;font-weight:bold">nil</span>))</span></span></code></pre></div><p>Also I want to use the Pause key (which I remapped onto my caps lock key) to expand snippets, since I find using tab for both snippets and autocompletion confusing.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">; first unmap tab for snippets</span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">yas-minor-mode-map</span> <span style="color:#8a93a5;font-style:italic">; key for snippet expansion</span>
</span></span><span style="display:flex;"><span>      [<span style="color:#dcaeea">tab</span>] <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;TAB&#34;</span> <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">yas-keymap</span> <span style="color:#8a93a5;font-style:italic">; keys for navigation</span>
</span></span><span style="display:flex;"><span>      [<span style="color:#dcaeea">tab</span>] <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;TAB&#34;</span> <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>      [(<span style="color:#dcaeea">shift</span> <span style="color:#dcaeea">tab</span>)] <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>      [<span style="color:#dcaeea">backtab</span>] <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">; then map pause for snippets instead</span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:map</span> <span style="color:#56b6c2">&#39;yas-minor-mode-map</span> <span style="color:#8a93a5;font-style:italic">; key for snippet expansion</span>
</span></span><span style="display:flex;"><span>      [<span style="color:#dcaeea">pause</span>] <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">yas-expand</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">yas-keymap</span> <span style="color:#8a93a5;font-style:italic">; keys for navigation</span>
</span></span><span style="display:flex;"><span>      [<span style="color:#dcaeea">pause</span>] <span style="color:#56b6c2">&#39;yas-next-field-or-maybe-expand</span>
</span></span><span style="display:flex;"><span>      [(<span style="color:#dcaeea">shift</span> <span style="color:#dcaeea">pause</span>)] <span style="color:#56b6c2">&#39;yas-prev</span>)</span></span></code></pre></div><p>TODO: Snippet expansion is somehow not unmapped from tab yet by this.</p>
<p>Some nicer shortcuts for creating snippets and etc. would also be nice.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:leader</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;y&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;YASnippet&#34;</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;edit snippet&#34;</span> <span style="color:#98c379">&#34;e&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">yas-visit-snippet-file</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;insert snippet&#34;</span> <span style="color:#98c379">&#34;i&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">yas-insert-snippet</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;new snippet&#34;</span> <span style="color:#98c379">&#34;n&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">+snippets/new</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;find private snippet&#34;</span> <span style="color:#98c379">&#34;p&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">+snippets/find-private</span>
</span></span><span style="display:flex;"><span>       )
</span></span><span style="display:flex;"><span>      )</span></span></code></pre></div><p>Hey boy, I heard you like snippets&hellip; so I put some snippets in your snippets&hellip;</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">yas-triggers-in-field</span> <span style="color:#b756ff;font-weight:bold">t</span>)</span></span></code></pre></div><h3 id="zen-writeroom">Zen/Writeroom</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:leader</span>
</span></span><span style="display:flex;"><span> (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;t&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;toggle&#34;</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Global writeroom mode&#34;</span>  <span style="color:#98c379">&#34;W&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">global-writeroom-mode</span>
</span></span><span style="display:flex;"><span>       )
</span></span><span style="display:flex;"><span>      )</span></span></code></pre></div><h2 id="org-mode">Org Mode</h2>
<h3 id="org-paths">Org-Paths</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-directory</span> <span style="color:#98c379">&#34;~/org/&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">org-roam-directory</span> <span style="color:#98c379">&#34;~/Dropbox/roam&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">org-cd-directory</span> (<span style="color:#00b1f7">concat</span> <span style="color:#dcaeea">org-roam-directory</span> <span style="color:#98c379">&#34;/tikz-cd&#34;</span>)) <span style="color:#8a93a5;font-style:italic">; for commutative diagrams</span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-agenda-files</span> (<span style="color:#00b1f7">list</span> <span style="color:#98c379">&#34;~/org/todo.org&#34;</span> <span style="color:#98c379">&#34;~/org/lv_Sommer2023.org&#34;</span>))</span></span></code></pre></div><h3 id="org-appearance">Org Appearance</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">org</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-ellipsis</span> <span style="color:#98c379">&#34; ▼ &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;;org-superstar-headline-bullets-list &#39;(&#34;◉&#34; &#34;●&#34; &#34;○&#34; &#34;◆&#34; &#34;●&#34; &#34;○&#34; &#34;◆&#34;)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-superstar-headline-bullets-list</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;❭&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-superstar-item-bullet-alist</span> <span style="color:#c7bf54">&#39;</span>((<span style="color:#98c379">?+</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">?✦</span>) (<span style="color:#98c379">?-</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">?➤</span>)) <span style="color:#8a93a5;font-style:italic">; changes +/- symbols in item lists</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-hide-emphasis-markers</span> <span style="color:#b756ff;font-weight:bold">t</span>     <span style="color:#8a93a5;font-style:italic">; do not show e.g. the asterisks when writing something in boldface</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-appear-autoemphasis</span> <span style="color:#b756ff;font-weight:bold">t</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-appear-autosubmarkers</span> <span style="color:#b756ff;font-weight:bold">t</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-appear-autolinks</span> <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-hidden-keywords</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">title</span>)  <span style="color:#8a93a5;font-style:italic">; hide #+TITLE:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-log-done</span> <span style="color:#56b6c2">&#39;time</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-agenda-skip-scheduled-if-done</span> <span style="color:#b756ff;font-weight:bold">t</span>     <span style="color:#8a93a5;font-style:italic">; do not show scheduled items in agenda if they&#39;re already done</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-agenda-skip-deadline-if-done</span> <span style="color:#b756ff;font-weight:bold">t</span>     <span style="color:#8a93a5;font-style:italic">; do not show deadlines in agenda if they&#39;re already done</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-deadline-warning-days</span> <span style="color:#d19a66">7</span>
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-todo-keywords</span>        <span style="color:#8a93a5;font-style:italic">; This overwrites the default Doom org-todo-keywords</span>
</span></span><span style="display:flex;"><span>          <span style="color:#c7bf54">&#39;</span>((<span style="color:#dcaeea">sequence</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;TODO(t)&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;WAIT(w)&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;TODELEGATE(T)&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;IDEA(i)&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;|&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;DONE(d)&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;DELEGATED(D)&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#98c379">&#34;CANCELLED(c)&#34;</span> ))
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">org-todo-keyword-faces</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c7bf54">&#39;</span>((<span style="color:#98c379">&#34;WAIT&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;#ECBE7B&#34;</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;TODELEGATE&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;pink&#34;</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;IDEA&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;cyan&#34;</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;DONE&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;#5b8c68&#34;</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;DELEGATED&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;#a9a1e1&#34;</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;CANCELLED&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;#ff6c6b&#34;</span>)
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">custom-set-faces!</span>
</span></span><span style="display:flex;"><span>  <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">org-level-1</span> <span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">outline-1</span> <span style="color:#ef8383">:height</span> <span style="color:#d19a66">1.4</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">org-level-2</span> <span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">outline-2</span> <span style="color:#ef8383">:height</span> <span style="color:#d19a66">1.25</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">org-level-3</span> <span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">outline-3</span> <span style="color:#ef8383">:height</span> <span style="color:#d19a66">1.1</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">org-level-4</span> <span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">outline-4</span> <span style="color:#ef8383">:height</span> <span style="color:#d19a66">1.05</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">org-level-5</span> <span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">outline-5</span> <span style="color:#ef8383">:height</span> <span style="color:#d19a66">1.0</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#c7bf54">`</span>(<span style="color:#dcaeea">org-document-title</span> <span style="color:#ef8383">:family</span> <span style="color:#98c379">&#34;K2D&#34;</span> <span style="color:#ef8383">:foreground</span> <span style="color:#98c379">&#34;#9BDB4D&#34;</span> <span style="color:#ef8383">:background</span> <span style="color:#b756ff;font-weight:bold">nil</span> <span style="color:#ef8383">:height</span> <span style="color:#d19a66">2.0</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div><h3 id="org-roam">Org Roam</h3>
<h4 id="capture">Capture</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-roam-capture-templates</span>
</span></span><span style="display:flex;"><span>      <span style="color:#c7bf54">&#39;</span>((<span style="color:#98c379">&#34;d&#34;</span> <span style="color:#98c379">&#34;default&#34;</span> <span style="color:#dcaeea">plain</span> <span style="color:#98c379">&#34;%?&#34;</span> <span style="color:#ef8383">:target</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#dcaeea">file+head</span> <span style="color:#98c379">&#34;%&lt;%Y%m%d%H%M%S&gt;-${slug}.org&#34;</span> <span style="color:#98c379">&#34;#+filetags: \n#+title: ${title}\n\n&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ef8383">:unnarrowed</span> <span style="color:#b756ff;font-weight:bold">t</span>)))</span></span></code></pre></div><p>Every node should be marked as a draft, until I revisit and refine it (stolen form <a href="https://jethrokuan.github.io/org-roam-guide/" target="_blank">here</a>)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">jethro/tag-new-node-as-draft</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-roam-tag-add</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;draft&#34;</span>)))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-roam-capture-new-node-hook</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">jethro/tag-new-node-as-draft</span>)</span></span></code></pre></div><p>Sometimes I want to link notes that are not created yet, but also don&rsquo;t want to be distracted from writing the current note.
This function (taken from <a href="https://systemcrafters.net/build-a-second-brain-in-emacs/5-org-roam-hacks/" target="_blank">SystemCrafters</a>) inserts the link without opening the new note in a new buffer. It uses the <em>first template</em> in <code>org-roam-capture-templates</code> for the new note.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-roam-node-insert-immediate</span> (<span style="color:#dcaeea">arg</span> <span style="color:#c678dd">&amp;rest</span> <span style="color:#dcaeea">args</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span> <span style="color:#98c379">&#34;P&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">args</span> (<span style="color:#00b1f7">cons</span> <span style="color:#dcaeea">arg</span> <span style="color:#dcaeea">args</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#dcaeea">org-roam-capture-templates</span> (<span style="color:#00b1f7">list</span> (<span style="color:#00b1f7">append</span> (<span style="color:#00b1f7">car</span> <span style="color:#dcaeea">org-roam-capture-templates</span>)
</span></span><span style="display:flex;"><span>                                                  <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:immediate-finish</span> <span style="color:#b756ff;font-weight:bold">t</span>) <span style="color:#8a93a5;font-style:italic">; this is the essential bit</span>
</span></span><span style="display:flex;"><span>                                                  ))))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">apply</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-node-insert</span> <span style="color:#dcaeea">args</span>)))</span></span></code></pre></div><p>Additionally, I&rsquo;m getting quite annoyed that links are inserted at the cursor position, not after the cursor position. Even though I guess this is consistent with usual vim functionality, having to press space twice feels weird to me, and binding a new key to have it work similar to &ldquo;append&rdquo; (&lsquo;a&rsquo; in vim) rather than &ldquo;insert&rdquo; (&lsquo;i&rsquo; in vim) is a bit unnecessary. So this workaround suits me best. (cf. <a href="https://github.com/syl20bnr/spacemacs/issues/14137" target="_blank">this issue</a>)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defadvice</span> <span style="color:#dcaeea">org-roam-node-insert</span> (<span style="color:#dcaeea">around</span> <span style="color:#dcaeea">append-if-in-evil-normal-mode</span> <span style="color:#dcaeea">activate</span> <span style="color:#dcaeea">compile</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;If in evil normal mode and cursor is on a whitespace character, then go into
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">append mode first before inserting the link. This is to put the link after the
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">space rather than before.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">is-in-evil-normal-mode</span> (<span style="color:#ef8383">and</span> (<span style="color:#dcaeea">bound-and-true-p</span> <span style="color:#dcaeea">evil-mode</span>)
</span></span><span style="display:flex;"><span>                                     (<span style="color:#dcaeea">not</span> (<span style="color:#dcaeea">bound-and-true-p</span> <span style="color:#dcaeea">evil-insert-state-minor-mode</span>))
</span></span><span style="display:flex;"><span>                                     (<span style="color:#00b1f7">looking-at</span> <span style="color:#98c379">&#34;[[:blank:]]&#34;</span>))))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> (<span style="color:#dcaeea">not</span> <span style="color:#dcaeea">is-in-evil-normal-mode</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#dcaeea">ad-do-it</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#dcaeea">evil-append</span> <span style="color:#d19a66">0</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#dcaeea">ad-do-it</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#dcaeea">evil-normal-state</span>))))</span></span></code></pre></div><h4 id="org-roam-ui">org-roam-ui</h4>
<p>One of the killer features associated with org roam are fancy graphs, as e.g. provided by <code>org-roam-ui</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">use-package!</span> <span style="color:#dcaeea">websocket</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">org-roam</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">use-package!</span> <span style="color:#dcaeea">org-roam-ui</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">org-roam</span> <span style="color:#8a93a5;font-style:italic">;; or :after org</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;         normally we&#39;d recommend hooking orui after org-roam, but since org-roam does not have</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;         a hookable mode anymore, you&#39;re advised to pick something yourself</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;         if you don&#39;t care about startup time, use</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;  :hook (after-init . org-roam-ui-mode)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:config</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-roam-ui-sync-theme</span> <span style="color:#b756ff;font-weight:bold">t</span>
</span></span><span style="display:flex;"><span>          <span style="color:#dcaeea">org-roam-ui-follow</span> <span style="color:#b756ff;font-weight:bold">t</span>
</span></span><span style="display:flex;"><span>          <span style="color:#dcaeea">org-roam-ui-update-on-save</span> <span style="color:#b756ff;font-weight:bold">t</span>
</span></span><span style="display:flex;"><span>          <span style="color:#dcaeea">org-roam-ui-open-on-start</span> <span style="color:#b756ff;font-weight:bold">nil</span>))</span></span></code></pre></div><h4 id="tagging-links">Tagging links</h4>
<p>While org-roam allows for files to be tagged, the links between files cannot. The following adds this functionality. Furthermore, I&rsquo;m using a <a href="https://github.com/odomanov/org-roam-ui" target="_blank">fork of org-roam-ui</a> which allows filtering these link tags and assigning colors to them (see <code>packages.el</code>). This whole issue is talked about at length in the org-roam discourse (e.g. <a href="https://org-roam.discourse.group/t/link-categorization/2486/3" target="_blank">here</a> and <a href="https://org-roam.discourse.group/t/add-link-tags-feature/171/34" target="_blank">here</a>), but the discussion that this code comes from is <a href="https://github.com/org-roam/org-roam-ui/discussions/25" target="_blank">here</a> (specifically this <a href="https://gist.github.com/odomanov/ed070a7faf3df1377fccf5d7c5000bf8" target="_blank">gist here</a>).</p>
<p>The syntax for these tagged links is
<code>[[&lt;link id&gt;|:tag &lt;tag&gt; :context &lt;short description&gt;][&lt;link title&gt;]]</code>.
Beware that this is different from what the author explains in the discussion linked above! It seems to be <code>:tag</code>, not <code>:tags</code>!</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;; org-roam-link-properties.el --- Frobnicate and bifurcate flanges</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;; Author: Oleg Domanov &lt;odomanov@yandex.ru&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;; Version: 1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;; Keywords: org-roam org-roam-ui</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;; Commentary:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;;  Org-Roam link properties (for &#39;id&#39; links only).</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;;  Adapted from https://linevi.ch/en/org-link-extra-attrs.html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;; Code:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">odm/org-link-extra-attrs</span> (<span style="color:#dcaeea">orig-fun</span> <span style="color:#c678dd">&amp;rest</span> <span style="color:#dcaeea">args</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Post processor for parsing links&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">parser-result</span> <span style="color:#dcaeea">orig-fun</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;;; Retrieving inital values that should be replaced</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">raw-path</span> (<span style="color:#00b1f7">plist-get</span> (<span style="color:#00b1f7">nth</span> <span style="color:#d19a66">1</span> <span style="color:#dcaeea">parser-result</span>) <span style="color:#ef8383">:raw-link</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; check if raw-path is not nil</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">raw-path</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8a93a5;font-style:italic">;; Checking if link match the regular expression</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">if</span> (<span style="color:#dcaeea">string-match-p</span> <span style="color:#98c379">&#34;^id:.*|\s*:&#34;</span> <span style="color:#dcaeea">raw-path</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">progn</span>
</span></span><span style="display:flex;"><span>                <span style="color:#8a93a5;font-style:italic">;; Retrieving parameters after the vertical bar</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">results</span> (<span style="color:#dcaeea">s-split</span> <span style="color:#98c379">&#34;|&#34;</span> <span style="color:#dcaeea">raw-path</span>))
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">raw-path</span> (<span style="color:#00b1f7">car</span> <span style="color:#dcaeea">results</span>))
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">path</span> (<span style="color:#dcaeea">s-chop-prefix</span> <span style="color:#98c379">&#34;id:&#34;</span> <span style="color:#dcaeea">raw-path</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8a93a5;font-style:italic">;; Cleaning, splitting and making symbols</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">results</span> (<span style="color:#dcaeea">s-split</span> <span style="color:#98c379">&#34;\s&#34;</span> (<span style="color:#dcaeea">s-trim</span> (<span style="color:#dcaeea">s-collapse-whitespace</span>
</span></span><span style="display:flex;"><span>                                                (<span style="color:#00b1f7">car</span> (<span style="color:#dcaeea">-slice</span> <span style="color:#dcaeea">results</span> <span style="color:#d19a66">1</span>))))))
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">results</span> (<span style="color:#dcaeea">--map</span> (<span style="color:#00b1f7">intern</span> <span style="color:#dcaeea">it</span>) <span style="color:#dcaeea">results</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8a93a5;font-style:italic">;; Updating the ouput with the new values</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">orig-fun-cleaned</span> (<span style="color:#00b1f7">plist-put</span> (<span style="color:#00b1f7">nth</span> <span style="color:#d19a66">1</span> <span style="color:#dcaeea">orig-fun</span>) <span style="color:#ef8383">:raw-link</span> <span style="color:#dcaeea">raw-path</span>))
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">orig-fun-cleaned</span> (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">orig-fun-cleaned</span> <span style="color:#ef8383">:path</span> <span style="color:#dcaeea">path</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#8a93a5;font-style:italic">;; Check that the number is even</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">if</span> (<span style="color:#00b1f7">=</span> <span style="color:#d19a66">2</span> (<span style="color:#00b1f7">length</span> (<span style="color:#dcaeea">-last-item</span> (<span style="color:#dcaeea">-partition-all</span> <span style="color:#d19a66">2</span> <span style="color:#dcaeea">results</span>))))
</span></span><span style="display:flex;"><span>                (<span style="color:#00b1f7">list</span> <span style="color:#56b6c2">&#39;link</span> (<span style="color:#dcaeea">-snoc</span> <span style="color:#dcaeea">orig-fun-cleaned</span> <span style="color:#ef8383">:extra-attrs</span> <span style="color:#dcaeea">results</span>))
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">progn</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#00b1f7">message</span> <span style="color:#98c379">&#34;Links properties are incorrect.&#34;</span>)
</span></span><span style="display:flex;"><span>                (<span style="color:#00b1f7">list</span> <span style="color:#56b6c2">&#39;link</span> <span style="color:#dcaeea">orig-fun-cleaned</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; Or returning original value of the function</span>
</span></span><span style="display:flex;"><span>    <span style="color:#dcaeea">orig-fun</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">advice-add</span> <span style="color:#56b6c2">&#39;org-element-link-parser</span> <span style="color:#ef8383">:filter-return</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">odm/org-link-extra-attrs</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">odm/org-roam-db-extra-properties</span> (<span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Append extra-attrs to the LINK&#39;s properties.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">save-excursion</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">goto-char</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:begin</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">path</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:path</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#dcaeea">source</span> (<span style="color:#dcaeea">org-roam-id-at-point</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#dcaeea">extra-attrs</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:extra-attrs</span> <span style="color:#dcaeea">link</span>)))
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">when</span> <span style="color:#dcaeea">extra-attrs</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">properties</span> (<span style="color:#dcaeea">caar</span> (<span style="color:#dcaeea">org-roam-db-query</span>
</span></span><span style="display:flex;"><span>                               [<span style="color:#ef8383">:select</span> <span style="color:#dcaeea">properties</span> <span style="color:#ef8383">:from</span> <span style="color:#dcaeea">links</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#ef8383">:where</span> (<span style="color:#00b1f7">=</span> <span style="color:#dcaeea">source</span> <span style="color:#dcaeea">$s1</span>) <span style="color:#ef8383">:and</span> (<span style="color:#00b1f7">=</span> <span style="color:#dcaeea">dest</span> <span style="color:#dcaeea">$s2</span>)
</span></span><span style="display:flex;"><span>                                        <span style="color:#ef8383">:limit</span> <span style="color:#d19a66">1</span>]
</span></span><span style="display:flex;"><span>                               <span style="color:#dcaeea">source</span> <span style="color:#dcaeea">path</span>)))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">properties</span> (<span style="color:#00b1f7">append</span> <span style="color:#dcaeea">properties</span> <span style="color:#dcaeea">extra-attrs</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">when</span> (<span style="color:#ef8383">and</span> <span style="color:#dcaeea">source</span> <span style="color:#dcaeea">path</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#dcaeea">org-roam-db-query</span>
</span></span><span style="display:flex;"><span>           [<span style="color:#ef8383">:update</span> <span style="color:#dcaeea">links</span> <span style="color:#ef8383">:set</span> (<span style="color:#00b1f7">=</span> <span style="color:#dcaeea">properties</span> <span style="color:#dcaeea">$s3</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#ef8383">:where</span> (<span style="color:#00b1f7">=</span> <span style="color:#dcaeea">source</span> <span style="color:#dcaeea">$s1</span>) <span style="color:#ef8383">:and</span> (<span style="color:#00b1f7">=</span> <span style="color:#dcaeea">dest</span> <span style="color:#dcaeea">$s2</span>)]
</span></span><span style="display:flex;"><span>           <span style="color:#dcaeea">source</span> <span style="color:#dcaeea">path</span> <span style="color:#dcaeea">properties</span>))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">advice-add</span> <span style="color:#56b6c2">&#39;org-roam-db-insert-link</span> <span style="color:#ef8383">:after</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">odm/org-roam-db-extra-properties</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">provide</span> <span style="color:#56b6c2">&#39;org-roam-link-properties</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;; org-roam-link-properties.el ends here</span></span></span></code></pre></div><p>My main use case for this are links tagged with &ldquo;implication&rdquo;. I use those when one mathematical property implies another. As a simple example, if my roam database had the nodes &ldquo;rational number&rdquo; and &ldquo;real number&rdquo;, then the former should have a link to the latter tagged with &ldquo;implication&rdquo;, since every rational number is a real number. Then I can filter for links tagged as implications in <code>org-roam-ui</code> to see how different mathematical structures relate to each other.</p>
<p>To make all this nice to use, let&rsquo;s write a bunch of functions to add and remove link tags. These are mostly based on the function <code>org-roam-link-replace-at-point</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-link-set-tags</span> (<span style="color:#c678dd">&amp;optional</span> <span style="color:#dcaeea">tags</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Set the tags of the link at point.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">save-excursion</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">save-match-data</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">let*</span> ((<span style="color:#dcaeea">tags</span> (<span style="color:#ef8383">or</span> <span style="color:#dcaeea">tags</span> (<span style="color:#00b1f7">read-string</span> <span style="color:#98c379">&#34;Tags: &#34;</span>)))
</span></span><span style="display:flex;"><span>             (<span style="color:#dcaeea">link</span> (<span style="color:#ef8383">or</span> <span style="color:#dcaeea">link</span> (<span style="color:#dcaeea">org-element-context</span>)))
</span></span><span style="display:flex;"><span>             (<span style="color:#dcaeea">raw-link</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:raw-link</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>             (<span style="color:#dcaeea">path</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:path</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>             (<span style="color:#dcaeea">desc</span> (<span style="color:#ef8383">and</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-begin</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-end</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>                        (<span style="color:#00b1f7">buffer-substring-no-properties</span>
</span></span><span style="display:flex;"><span>                         (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-begin</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>                         (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-end</span> <span style="color:#dcaeea">link</span>))))
</span></span><span style="display:flex;"><span>             <span style="color:#dcaeea">node</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#00b1f7">goto-char</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:begin</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">when</span> (<span style="color:#dcaeea">org-in-regexp</span> <span style="color:#dcaeea">org-link-any-re</span> <span style="color:#d19a66">1</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">replace-match</span> (<span style="color:#dcaeea">org-link-make-string</span>
</span></span><span style="display:flex;"><span>                          (<span style="color:#00b1f7">concat</span> <span style="color:#dcaeea">raw-link</span> <span style="color:#98c379">&#34;|:tag &#34;</span> <span style="color:#dcaeea">tags</span>)
</span></span><span style="display:flex;"><span>                          (<span style="color:#ef8383">or</span> <span style="color:#dcaeea">desc</span> <span style="color:#dcaeea">path</span>))))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-link-remove-tags</span> (<span style="color:#c678dd">&amp;optional</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Remove the tags of the link at point.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">save-excursion</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">save-match-data</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">let*</span> ((<span style="color:#dcaeea">link</span> (<span style="color:#ef8383">or</span> <span style="color:#dcaeea">link</span> (<span style="color:#dcaeea">org-element-context</span>)))
</span></span><span style="display:flex;"><span>             (<span style="color:#dcaeea">raw-link</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:raw-link</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>             (<span style="color:#dcaeea">path</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:path</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>             (<span style="color:#dcaeea">desc</span> (<span style="color:#ef8383">and</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-begin</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>                        (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-end</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>                        (<span style="color:#00b1f7">buffer-substring-no-properties</span>
</span></span><span style="display:flex;"><span>                         (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-begin</span> <span style="color:#dcaeea">link</span>)
</span></span><span style="display:flex;"><span>                         (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:contents-end</span> <span style="color:#dcaeea">link</span>))))
</span></span><span style="display:flex;"><span>             <span style="color:#dcaeea">node</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#00b1f7">goto-char</span> (<span style="color:#dcaeea">org-element-property</span> <span style="color:#ef8383">:begin</span> <span style="color:#dcaeea">link</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">when</span> (<span style="color:#dcaeea">org-in-regexp</span> <span style="color:#dcaeea">org-link-any-re</span> <span style="color:#d19a66">1</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">replace-match</span> (<span style="color:#dcaeea">org-link-make-string</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#dcaeea">raw-link</span>
</span></span><span style="display:flex;"><span>                          (<span style="color:#ef8383">or</span> <span style="color:#dcaeea">desc</span> <span style="color:#dcaeea">path</span>))))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-roam-implication-tag</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Tag link at point as implication&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-link-set-tags</span> <span style="color:#98c379">&#34;implication&#34;</span>)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-roam-implication-insert</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;org-roam-node-insert, but the link is tagged with \&#34;implication\&#34;\n TODO: Does not currently work when a new node is created!&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-roam-node-insert</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-link-set-tags</span> <span style="color:#98c379">&#34;implication&#34;</span>)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-roam-implication-insert-immediate</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;org-roam-node-insert-immediately, but the link is tagged with \&#34;implication\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-roam-node-insert-immediate</span> <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-link-set-tags</span> <span style="color:#98c379">&#34;implication&#34;</span>)
</span></span><span style="display:flex;"><span>  )</span></span></code></pre></div><h4 id="commutative-diagrams">Commutative Diagrams</h4>
<p>I want to use commutative diagrams in some of my roam notes, using the LaTeX-package <code>tikz-cd</code>. However, doing that in LaTeX fragments doesn&rsquo;t work with <code>org-roam-ui</code> (since that just uses KaTeX, which doesn&rsquo;t support everything in LaTeX). On the other hand, doing it using src-blocks is also not great, cause then the distracting source code is gonna appear both in org and in the UI.</p>
<p>My solution to that is creating a capture template for commutative diagrams (inspired by <a href="https://github.com/darknmt/org-tikzcd-snippet" target="_blank">this</a>). This is done using regular <code>org-capture</code>, since I don&rsquo;t want those files to have IDs and show up in my roam database. This works as follows:</p>
<ul>
<li>Upon running <code>org-capture-commutative-diagram</code>, the user is first prompted for a file name.</li>
<li>Afterwards, an org file is created, where the file name is prefixed with a time stamp. The file already contains a <code>tikz-cd</code> block, and all options necessary for export.</li>
<li>Now the user may type the commutative diagram of their dreams.</li>
<li>After completing the capture with <code>C-c C-c</code>, the diagram will be rendered to a png image by LaTeX/imagemagick. After this is finished, the capture buffer closes, and a link to the image is inserted in the previously opened buffer.</li>
</ul>
<p>For the actual capture template: The code is passed both through <code>format</code> and through <code>org-capture</code>, which necessitates double escaping quotations and backspaces. This makes it super hard to read, so I suggest you just try it out if you wanna see what it does. ^^ The <code>%%</code> is a masked percentage sign btw.
Also there are checks in place to make sure the functions place in <code>org-capture</code>-hooks are only run when actually creating a commutative diagram (cf. <a href="https://emacs.stackexchange.com/a/48567" target="_blank">stackexchange</a>).</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">commutative-diagram-filename-generate</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">commutative-diagram-filename--name</span> (<span style="color:#00b1f7">read-string</span> <span style="color:#98c379">&#34;Name: &#34;</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">commutative-diagram-filename--time</span> (<span style="color:#00b1f7">format-time-string</span> <span style="color:#98c379">&#34;%Y%m%d%H%M%S&#34;</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">commutative-diagram-filename--image</span> (<span style="color:#00b1f7">expand-file-name</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%s-%s.png&#34;</span> <span style="color:#dcaeea">commutative-diagram-filename--time</span> <span style="color:#dcaeea">commutative-diagram-filename--name</span>) <span style="color:#dcaeea">org-cd-directory</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">commutative-diagram-filename--org</span> (<span style="color:#00b1f7">expand-file-name</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%s-%s.org&#34;</span> <span style="color:#dcaeea">commutative-diagram-filename--time</span> <span style="color:#dcaeea">commutative-diagram-filename--name</span>) <span style="color:#dcaeea">org-cd-directory</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">org-capture</span> (<span style="color:#dcaeea">add-to-list</span> <span style="color:#56b6c2">&#39;org-capture-templates</span>
</span></span><span style="display:flex;"><span>  <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;c&#34;</span> <span style="color:#98c379">&#34;Commutative Diagram&#34;</span> <span style="color:#dcaeea">plain</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#dcaeea">file</span> <span style="color:#dcaeea">commutative-diagram-filename-generate</span>)
</span></span><span style="display:flex;"><span>     <span style="color:#98c379">&#34;%(format \&#34;#+TITLE: %s\n#+STAMP: %s\n#+HEADER: :imagemagick yes :iminoptions -density 600 -geometry 1500 :buffer no :fit yes \n#+HEADER: :results raw  :file %s-%s.png \n#+HEADER: :packages &#39;((\\\&#34;\\\&#34; \\\&#34;tikz-cd\\\&#34;)) \n#+HEADER: :exports results :results output graphics file \n#+BEGIN_SRC latex \n\\\\begin{tikzcd}[white]\n %%? \n\\\\end{tikzcd}\n#+END_SRC\&#34; commutative-diagram-filename--name commutative-diagram-filename--time commutative-diagram-filename--time commutative-diagram-filename--name)&#34;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-capture-commutative-diagram--render</span> ()
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">when</span> (<span style="color:#ef8383">and</span> (<span style="color:#dcaeea">not</span> <span style="color:#dcaeea">org-note-abort</span>) (<span style="color:#00b1f7">equal</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">org-capture-plist</span> <span style="color:#ef8383">:key</span>) <span style="color:#98c379">&#34;c&#34;</span>)) <span style="color:#8a93a5;font-style:italic">; execute only for the commutative diagram capture template</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">org-babel-execute-buffer</span>)))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">org-capture</span> (<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-capture-before-finalize-hook</span> <span style="color:#56b6c2">&#39;org-capture-commutative-diagram--render</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-capture-commutative-diagram--insert-link</span> () (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">when</span> (<span style="color:#ef8383">and</span> (<span style="color:#dcaeea">not</span> <span style="color:#dcaeea">org-note-abort</span>) (<span style="color:#00b1f7">equal</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">org-capture-plist</span> <span style="color:#ef8383">:key</span>) <span style="color:#98c379">&#34;c&#34;</span>)) <span style="color:#8a93a5;font-style:italic">; execute only for the commutative diagram capture template</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">evil-open-below</span> <span style="color:#d19a66">1</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;[[&#34;</span> <span style="color:#dcaeea">commutative-diagram-filename--image</span> <span style="color:#98c379">&#34;]]\n&#34;</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">evil-normal-state</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">org-redisplay-inline-images</span>)
</span></span><span style="display:flex;"><span>))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">org-capture</span> (<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-capture-after-finalize-hook</span> <span style="color:#56b6c2">&#39;org-capture-commutative-diagram--insert-link</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-capture-commutative-diagram</span> () (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">org-capture</span> <span style="color:#b756ff;font-weight:bold">nil</span> <span style="color:#98c379">&#34;c&#34;</span>)
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div><h4 id="keybindings">Keybindings</h4>
<p>Basically taking the default keybindings and moving them to <code>SPC r</code>, which was still free.
Only change is that I&rsquo;m using <code>org-roam-ui</code> for the graph.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:leader</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;r&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;roam&#34;</span>)
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Open random node&#34;</span>           <span style="color:#98c379">&#34;0&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-node-random</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Find node&#34;</span>                  <span style="color:#98c379">&#34;f&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-node-find</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Find ref&#34;</span>                   <span style="color:#98c379">&#34;F&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ref-find</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Show UI&#34;</span>                    <span style="color:#98c379">&#34;g&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-open</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Insert node&#34;</span>                <span style="color:#98c379">&#34;i&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-node-insert</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Insert node immediately&#34;</span>    <span style="color:#98c379">&#34;I&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-node-insert-immediate</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Insert imp. immediately&#34;</span>    <span style="color:#98c379">&#34;j&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-implication-insert-immediate</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Tag link as implication&#34;</span>    <span style="color:#98c379">&#34;J&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-implication-tag</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Capture to node&#34;</span>            <span style="color:#98c379">&#34;n&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-capture</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Toggle roam buffer&#34;</span>         <span style="color:#98c379">&#34;r&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-buffer-toggle</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Launch roam buffer&#34;</span>         <span style="color:#98c379">&#34;R&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-buffer-display-dedicated</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Sync database&#34;</span>              <span style="color:#98c379">&#34;s&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-db-sync</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Add tag&#34;</span>                    <span style="color:#98c379">&#34;t&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-tag-add</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Remove tag&#34;</span>                 <span style="color:#98c379">&#34;T&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-tag-remove</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Set link tags&#34;</span>              <span style="color:#98c379">&#34;l&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-link-set-tags</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Remove link tags&#34;</span>           <span style="color:#98c379">&#34;L&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-link-remove-tags</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Add alias&#34;</span>                  <span style="color:#98c379">&#34;a&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-alias-add</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Remove alias&#34;</span>               <span style="color:#98c379">&#34;A&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-alias-remove</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Commutative diagram&#34;</span>        <span style="color:#98c379">&#34;c&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-capture-commutative-diagram</span>
</span></span><span style="display:flex;"><span>         (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;d&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;by date&#34;</span>)
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Goto previous note&#34;</span>        <span style="color:#98c379">&#34;b&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-goto-previous-note</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Goto date&#34;</span>                 <span style="color:#98c379">&#34;d&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-goto-date</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Capture date&#34;</span>              <span style="color:#98c379">&#34;D&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-capture-date</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Goto next note&#34;</span>            <span style="color:#98c379">&#34;f&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-goto-next-note</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Goto tomorrow&#34;</span>             <span style="color:#98c379">&#34;m&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-goto-tomorrow</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Capture tomorrow&#34;</span>          <span style="color:#98c379">&#34;M&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-capture-tomorrow</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Capture today&#34;</span>             <span style="color:#98c379">&#34;n&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-capture-today</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Goto today&#34;</span>                <span style="color:#98c379">&#34;t&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-goto-today</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Capture today&#34;</span>             <span style="color:#98c379">&#34;T&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-capture-today</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Goto yesterday&#34;</span>            <span style="color:#98c379">&#34;y&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-goto-yesterday</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Capture yesterday&#34;</span>         <span style="color:#98c379">&#34;Y&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-capture-yesterday</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;Find directory&#34;</span>            <span style="color:#98c379">&#34;-&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-dailies-find-directory</span>)))</span></span></code></pre></div><p>Then additionally, I want quick control over the UI from the local leader.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">org</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">org-mode-map</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:localleader</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;u&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;org-roam-ui&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;o&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-open</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;z&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-node-zoom</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;l&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-node-local</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;T&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-sync-theme</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;f&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-follow-mode</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;a&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-add-to-local-graph</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;c&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-change-local-graph</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;r&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-roam-ui-remove-from-local-graph</span>)</span></span></code></pre></div><h4 id="roam-pseudohook">Roam Pseudohook</h4>
<p>It&rsquo;d be nice to be able to toggle some settings only for roam notes. Usually this would be done via the hook of a mode. But roam notes are just org files, and I don&rsquo;t want those settings on all org files. So let&rsquo;s create something I&rsquo;ll call a &ldquo;pseudohook&rdquo;. The function will run the hook if the current buffer file name is in <code>org-roam-directory</code>. By adding this function to <code>org-mode-hook</code>, the <code>roam-pseudohook</code> will apply exactly to the org files in <code>org-roam-directory</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defvar</span> <span style="color:#dcaeea">roam-pseudohook</span> <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span> <span style="color:#98c379">&#34;A hook run only on org files in org-roam-directory.&#34;</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">roam-pseudohook-function</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">cond</span> ((<span style="color:#dcaeea">string-prefix-p</span> <span style="color:#dcaeea">org-roam-directory</span> (<span style="color:#00b1f7">buffer-file-name</span>))
</span></span><span style="display:flex;"><span>         (<span style="color:#00b1f7">run-hooks</span> <span style="color:#56b6c2">&#39;roam-pseudohook</span>)
</span></span><span style="display:flex;"><span>         )))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">org</span> (<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-mode-hook</span> <span style="color:#56b6c2">&#39;roam-pseudohook-function</span>))</span></span></code></pre></div><h4 id="appearance">Appearance</h4>
<p>I want org roam notes to have special appearance.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;roam-pseudohook</span> (<span style="color:#ef8383">lambda</span> () (<span style="color:#dcaeea">window-margin-mode</span> <span style="color:#d19a66">1</span>)))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;roam-pseudohook</span> (<span style="color:#ef8383">lambda</span> () (<span style="color:#dcaeea">mixed-pitch-mode</span> <span style="color:#d19a66">1</span>)))</span></span></code></pre></div><p>Writeroom mode isn&rsquo;t a great idea during capture buffers. Let&rsquo;s add a hook to <code>org-capture-mode</code> to disable it.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">writeroom-mode-deactivate</span> () (<span style="color:#dcaeea">writeroom-mode</span> <span style="color:#d19a66">-1</span>))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-roam-capture-new-node-hook</span> <span style="color:#56b6c2">&#39;writeroom-mode-deactivate</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-capture-mode-hook</span> <span style="color:#56b6c2">&#39;writeroom-mode-deactivate</span>)</span></span></code></pre></div><p>I want to see my tags when searching for notes.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-roam-node-display-template</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#00b1f7">concat</span> <span style="color:#98c379">&#34;${title:*} &#34;</span>
</span></span><span style="display:flex;"><span>              (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;${tags:30}&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;org-tag</span>))) <span style="color:#8a93a5;font-style:italic">; 30 is the max. number of characters allocated for tags</span></span></span></code></pre></div><h3 id="org-latex-previews">Org LaTeX previews</h3>
<h4 id="the-fancy-new-system">The fancy new system™</h4>
<p>There is a fancy new LaTeX preview system underway. It is being developed by <a href="https://karthinks.com/" target="_blank">Karthink</a> and <a href="https://tecosaur.github.io/emacs-config/config.html" target="_blank">Tecosaur</a>. It makes rendering previews asynchronous (meaning emacs doesn&rsquo;t need to wait until they&rsquo;re done) and really fast. It also makes some improvements on appearance, such as previews scaling with font size and being properly aligned with the surrounding text. More info <a href="https://abode.karthinks.com/org-latex-preview/" target="_blank">here</a>.</p>
<p>Currently, the patch of org mode that contains this fancy system has to be installed manually. It is kinda tedious, more info on the page linked above. The big issue is that often there will still be some remains of the old org version loaded, resulting in a mixed installation that makes nothing work. For me it was necessary to</p>
<ul>
<li>completely reinstall doom without anything org related (so all modules that load org in <code>init.el</code> commented out) to really get rid of the old version of org,</li>
<li>then install the new patch</li>
<li>and only then install all other org related packages.</li>
<li>I also needed a new full TeXLive installation (to have packages like <a href="https://ctan.org/pkg/mylatexformat?lang=de" target="_blank">mylatexformat</a>) and rebuild emacs with svg support enabled.</li>
</ul>
<p>Thankfully, it is planned to have the new system merged into org mode itself, which will get rid of all of this messy installation.</p>
<p>To check whether everything is correctly installed, there&rsquo;s this neat function:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-latex-preview-check-health</span> (<span style="color:#c678dd">&amp;optional</span> <span style="color:#dcaeea">inter</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Inspect the relevent system state and setup.
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">INTER signals whether the function has been called interactively.&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span> (<span style="color:#00b1f7">list</span> <span style="color:#b756ff;font-weight:bold">t</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; Collect information</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">let*</span> ((<span style="color:#dcaeea">diag</span> <span style="color:#c7bf54">`</span>(<span style="color:#ef8383">:interactive</span> <span style="color:#c7bf54">,</span><span style="color:#dcaeea">inter</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">diag</span> <span style="color:#ef8383">:org-version</span> <span style="color:#dcaeea">org-version</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; modified variables</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">diag</span> <span style="color:#ef8383">:modified</span>
</span></span><span style="display:flex;"><span>               (<span style="color:#ef8383">let</span> ((<span style="color:#00b1f7">list</span>))
</span></span><span style="display:flex;"><span>                 (<span style="color:#00b1f7">mapatoms</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#ef8383">lambda</span> (<span style="color:#dcaeea">v</span>)
</span></span><span style="display:flex;"><span>                    (<span style="color:#ef8383">and</span> (<span style="color:#00b1f7">boundp</span> <span style="color:#dcaeea">v</span>)
</span></span><span style="display:flex;"><span>                         (<span style="color:#00b1f7">string-match</span> <span style="color:#98c379">&#34;\\`\\(org-latex-\\|org-persist-\\)&#34;</span> (<span style="color:#00b1f7">symbol-name</span> <span style="color:#dcaeea">v</span>))
</span></span><span style="display:flex;"><span>                         (<span style="color:#ef8383">or</span> (<span style="color:#ef8383">and</span> (<span style="color:#00b1f7">symbol-value</span> <span style="color:#dcaeea">v</span>)
</span></span><span style="display:flex;"><span>                                  (<span style="color:#00b1f7">string-match</span> <span style="color:#98c379">&#34;\\(-hook\\|-function\\)\\&#39;&#34;</span> (<span style="color:#00b1f7">symbol-name</span> <span style="color:#dcaeea">v</span>)))
</span></span><span style="display:flex;"><span>                             (<span style="color:#ef8383">and</span>
</span></span><span style="display:flex;"><span>                              (<span style="color:#00b1f7">get</span> <span style="color:#dcaeea">v</span> <span style="color:#56b6c2">&#39;custom-type</span>) (<span style="color:#00b1f7">get</span> <span style="color:#dcaeea">v</span> <span style="color:#56b6c2">&#39;standard-value</span>)
</span></span><span style="display:flex;"><span>                              (<span style="color:#dcaeea">not</span> (<span style="color:#00b1f7">equal</span> (<span style="color:#00b1f7">symbol-value</span> <span style="color:#dcaeea">v</span>)
</span></span><span style="display:flex;"><span>                                          (<span style="color:#00b1f7">eval</span> (<span style="color:#00b1f7">car</span> (<span style="color:#00b1f7">get</span> <span style="color:#dcaeea">v</span> <span style="color:#56b6c2">&#39;standard-value</span>)) <span style="color:#b756ff;font-weight:bold">t</span>)))))
</span></span><span style="display:flex;"><span>                         (<span style="color:#ef8383">push</span> (<span style="color:#00b1f7">cons</span> <span style="color:#dcaeea">v</span> (<span style="color:#00b1f7">symbol-value</span> <span style="color:#dcaeea">v</span>)) <span style="color:#00b1f7">list</span>))))
</span></span><span style="display:flex;"><span>                 <span style="color:#00b1f7">list</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; Executables</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; latex processors</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">dolist</span> (<span style="color:#dcaeea">processor</span> <span style="color:#dcaeea">org-latex-compilers</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#dcaeea">when-let</span> ((<span style="color:#dcaeea">path</span> (<span style="color:#dcaeea">executable-find</span> <span style="color:#dcaeea">processor</span>)))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">version</span> (<span style="color:#ef8383">with-temp-buffer</span>
</span></span><span style="display:flex;"><span>                         (<span style="color:#dcaeea">thread-last</span>
</span></span><span style="display:flex;"><span>                           (<span style="color:#00b1f7">concat</span> <span style="color:#dcaeea">processor</span> <span style="color:#98c379">&#34; --version&#34;</span>)
</span></span><span style="display:flex;"><span>                           (<span style="color:#dcaeea">shell-command-to-string</span>)
</span></span><span style="display:flex;"><span>                           (<span style="color:#00b1f7">insert</span>))
</span></span><span style="display:flex;"><span>                         (<span style="color:#00b1f7">goto-char</span> (<span style="color:#00b1f7">point-min</span>))
</span></span><span style="display:flex;"><span>                         (<span style="color:#00b1f7">buffer-substring</span> (<span style="color:#00b1f7">point</span>) (<span style="color:#00b1f7">line-end-position</span>)))))
</span></span><span style="display:flex;"><span>          (<span style="color:#ef8383">push</span> (<span style="color:#00b1f7">list</span> <span style="color:#dcaeea">processor</span> <span style="color:#dcaeea">version</span> <span style="color:#dcaeea">path</span>) (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">diag</span> <span style="color:#ef8383">:latex-processors</span>)))))
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; Image converters</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">dolist</span> (<span style="color:#dcaeea">converter</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;dvipng&#34;</span> <span style="color:#98c379">&#34;dvisvgm&#34;</span> <span style="color:#98c379">&#34;convert&#34;</span>))
</span></span><span style="display:flex;"><span>      (<span style="color:#dcaeea">when-let</span> ((<span style="color:#dcaeea">path</span> (<span style="color:#dcaeea">executable-find</span> <span style="color:#dcaeea">converter</span>)))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">version</span> (<span style="color:#ef8383">with-temp-buffer</span>
</span></span><span style="display:flex;"><span>                         (<span style="color:#dcaeea">thread-last</span>
</span></span><span style="display:flex;"><span>                           (<span style="color:#00b1f7">concat</span> <span style="color:#dcaeea">converter</span> <span style="color:#98c379">&#34; --version&#34;</span>)
</span></span><span style="display:flex;"><span>                           (<span style="color:#dcaeea">shell-command-to-string</span>)
</span></span><span style="display:flex;"><span>                           (<span style="color:#00b1f7">insert</span>))
</span></span><span style="display:flex;"><span>                         (<span style="color:#00b1f7">goto-char</span> (<span style="color:#00b1f7">point-min</span>))
</span></span><span style="display:flex;"><span>                         (<span style="color:#00b1f7">buffer-substring</span> (<span style="color:#00b1f7">point</span>) (<span style="color:#00b1f7">line-end-position</span>)))))
</span></span><span style="display:flex;"><span>          (<span style="color:#ef8383">push</span> (<span style="color:#00b1f7">list</span> <span style="color:#dcaeea">converter</span> <span style="color:#dcaeea">version</span> <span style="color:#dcaeea">path</span>) (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">diag</span> <span style="color:#ef8383">:image-converters</span>)))))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">when</span> <span style="color:#dcaeea">inter</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">with-current-buffer</span> (<span style="color:#00b1f7">get-buffer-create</span> <span style="color:#98c379">&#34;*Org LaTeX Preview Report*&#34;</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">inhibit-read-only</span> <span style="color:#b756ff;font-weight:bold">t</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">erase-buffer</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;Your LaTeX preview process&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;outline-1</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;\n\n&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          (<span style="color:#ef8383">let*</span> ((<span style="color:#dcaeea">latex-available</span> (<span style="color:#dcaeea">cl-member</span> <span style="color:#dcaeea">org-latex-compiler</span>
</span></span><span style="display:flex;"><span>                                             (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">diag</span> <span style="color:#ef8383">:latex-processors</span>)
</span></span><span style="display:flex;"><span>                                             <span style="color:#ef8383">:key</span> <span style="color:#00b1f7">#&#39;car</span> <span style="color:#ef8383">:test</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">string=</span>))
</span></span><span style="display:flex;"><span>                 (<span style="color:#dcaeea">precompile-available</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#ef8383">and</span> <span style="color:#dcaeea">latex-available</span>
</span></span><span style="display:flex;"><span>                       (<span style="color:#dcaeea">not</span> (<span style="color:#00b1f7">member</span> <span style="color:#dcaeea">org-latex-compiler</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;lualatex&#34;</span> <span style="color:#98c379">&#34;xelatex&#34;</span>)))))
</span></span><span style="display:flex;"><span>                 (<span style="color:#dcaeea">proc-info</span> (<span style="color:#dcaeea">alist-get</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#dcaeea">org-latex-preview-process-default</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#dcaeea">org-latex-preview-process-alist</span>))
</span></span><span style="display:flex;"><span>                 (<span style="color:#dcaeea">image-converter</span> (<span style="color:#dcaeea">cadr</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">proc-info</span> <span style="color:#ef8383">:programs</span>)))
</span></span><span style="display:flex;"><span>                 (<span style="color:#dcaeea">image-converter</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#dcaeea">cl-find-if</span>
</span></span><span style="display:flex;"><span>                   (<span style="color:#ef8383">lambda</span> (<span style="color:#dcaeea">c</span>)
</span></span><span style="display:flex;"><span>                     (<span style="color:#dcaeea">string=</span> <span style="color:#dcaeea">image-converter</span> <span style="color:#dcaeea">c</span>))
</span></span><span style="display:flex;"><span>                   (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">diag</span> <span style="color:#ef8383">:image-converters</span>)
</span></span><span style="display:flex;"><span>                   <span style="color:#ef8383">:key</span> <span style="color:#00b1f7">#&#39;car</span>))
</span></span><span style="display:flex;"><span>                 (<span style="color:#dcaeea">image-output-type</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">proc-info</span> <span style="color:#ef8383">:image-output-type</span>)))
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">org-latex-preview-process-precompiled</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;Precompile with &#34;</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#00b1f7">propertize</span> (<span style="color:#dcaeea">map-elt</span> <span style="color:#dcaeea">org-latex-precompile-compiler-map</span>
</span></span><span style="display:flex;"><span>                                             <span style="color:#dcaeea">org-latex-compiler</span>)
</span></span><span style="display:flex;"><span>                                    <span style="color:#56b6c2">&#39;face</span>
</span></span><span style="display:flex;"><span>                                    (<span style="color:#00b1f7">list</span>
</span></span><span style="display:flex;"><span>                                     (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">precompile-available</span>
</span></span><span style="display:flex;"><span>                                         <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">success</span> <span style="color:#ef8383">:box</span> <span style="color:#b756ff;font-weight:bold">t</span>)
</span></span><span style="display:flex;"><span>                                       <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:inherit</span> <span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#ef8383">:box</span> <span style="color:#b756ff;font-weight:bold">t</span>))
</span></span><span style="display:flex;"><span>                                     <span style="color:#56b6c2">&#39;org-block</span>))
</span></span><span style="display:flex;"><span>                        <span style="color:#98c379">&#34; → &#34;</span>))
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;LaTeX Compile with &#34;</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#00b1f7">propertize</span> <span style="color:#dcaeea">org-latex-compiler</span> <span style="color:#56b6c2">&#39;face</span>
</span></span><span style="display:flex;"><span>                                (<span style="color:#00b1f7">list</span>
</span></span><span style="display:flex;"><span>                                 (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">latex-available</span>
</span></span><span style="display:flex;"><span>                                     <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">success</span> <span style="color:#ef8383">:box</span> <span style="color:#b756ff;font-weight:bold">t</span>)
</span></span><span style="display:flex;"><span>                                   <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:inherit</span> <span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#ef8383">:box</span> <span style="color:#b756ff;font-weight:bold">t</span>))
</span></span><span style="display:flex;"><span>                                 <span style="color:#56b6c2">&#39;org-block</span>))
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34; → &#34;</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;Convert to &#34;</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#00b1f7">propertize</span> (<span style="color:#00b1f7">upcase</span> <span style="color:#dcaeea">image-output-type</span>) <span style="color:#56b6c2">&#39;face</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:weight</span> <span style="color:#dcaeea">bold</span>))
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34; with &#34;</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#00b1f7">propertize</span> (<span style="color:#00b1f7">car</span> <span style="color:#dcaeea">image-converter</span>) <span style="color:#56b6c2">&#39;face</span>
</span></span><span style="display:flex;"><span>                                (<span style="color:#00b1f7">list</span>
</span></span><span style="display:flex;"><span>                                 (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">image-converter</span>
</span></span><span style="display:flex;"><span>                                     <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">success</span> <span style="color:#ef8383">:box</span> <span style="color:#b756ff;font-weight:bold">t</span>)
</span></span><span style="display:flex;"><span>                                   <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:inherit</span> <span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#ef8383">:box</span> <span style="color:#b756ff;font-weight:bold">t</span>))
</span></span><span style="display:flex;"><span>                                 <span style="color:#56b6c2">&#39;org-block</span>))
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34;\n\n&#34;</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span> <span style="color:#dcaeea">org-latex-compiler</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;outline-3</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">latex-available</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#00b1f7">concat</span>
</span></span><span style="display:flex;"><span>                          (<span style="color:#00b1f7">propertize</span>
</span></span><span style="display:flex;"><span>                           (<span style="color:#00b1f7">mapconcat</span> <span style="color:#00b1f7">#&#39;identity</span> (<span style="color:#dcaeea">map-nested-elt</span> <span style="color:#dcaeea">diag</span> <span style="color:#c7bf54">`</span>(<span style="color:#ef8383">:latex-processors</span> <span style="color:#c7bf54">,</span><span style="color:#dcaeea">org-latex-compiler</span>))
</span></span><span style="display:flex;"><span>                                      <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>                           <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;org-block</span>)
</span></span><span style="display:flex;"><span>                          <span style="color:#98c379">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>                          (<span style="color:#ef8383">when</span> (<span style="color:#ef8383">and</span> <span style="color:#dcaeea">latex-available</span> (<span style="color:#dcaeea">not</span> <span style="color:#dcaeea">precompile-available</span>))
</span></span><span style="display:flex;"><span>                            (<span style="color:#00b1f7">propertize</span>
</span></span><span style="display:flex;"><span>                             (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;\nWarning: Precompilation not available with %S!\n&#34;</span> <span style="color:#dcaeea">org-latex-compiler</span>)
</span></span><span style="display:flex;"><span>                             <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;warning</span>)))
</span></span><span style="display:flex;"><span>                      (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;Not found in path!\n&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;error</span>))
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span> (<span style="color:#dcaeea">cadr</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">proc-info</span> <span style="color:#ef8383">:programs</span>)) <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;outline-3</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">image-converter</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#00b1f7">propertize</span>
</span></span><span style="display:flex;"><span>                         (<span style="color:#00b1f7">concat</span>
</span></span><span style="display:flex;"><span>                          (<span style="color:#00b1f7">mapconcat</span> <span style="color:#00b1f7">#&#39;identity</span> (<span style="color:#00b1f7">cdr</span> <span style="color:#dcaeea">image-converter</span>) <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>                          <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>                         <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;org-block</span>)
</span></span><span style="display:flex;"><span>                      (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;Not found in path!\n&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;error</span>))
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#8a93a5;font-style:italic">;; dvisvgm version check</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">when</span> (<span style="color:#00b1f7">equal</span> (<span style="color:#00b1f7">car-safe</span> <span style="color:#dcaeea">image-converter</span>)
</span></span><span style="display:flex;"><span>                         <span style="color:#98c379">&#34;dvisvgm&#34;</span>)
</span></span><span style="display:flex;"><span>              (<span style="color:#ef8383">let*</span> ((<span style="color:#dcaeea">version-string</span> (<span style="color:#dcaeea">cadr</span> <span style="color:#dcaeea">image-converter</span>))
</span></span><span style="display:flex;"><span>                     (<span style="color:#dcaeea">dvisvgm-ver</span> (<span style="color:#ef8383">progn</span>
</span></span><span style="display:flex;"><span>                                    (<span style="color:#00b1f7">string-match</span> <span style="color:#98c379">&#34;\\([0-9.]+\\)&#34;</span> <span style="color:#dcaeea">version-string</span>)
</span></span><span style="display:flex;"><span>                                    (<span style="color:#dcaeea">match-string</span> <span style="color:#d19a66">1</span> <span style="color:#dcaeea">version-string</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                (<span style="color:#ef8383">when</span> (<span style="color:#dcaeea">version&lt;</span> <span style="color:#dcaeea">dvisvgm-ver</span> <span style="color:#98c379">&#34;3.0&#34;</span>)
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span>
</span></span><span style="display:flex;"><span>                           (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;Warning: dvisvgm version %s &lt; 3.0, displaymath will not be centered.&#34;</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#dcaeea">dvisvgm-ver</span>)
</span></span><span style="display:flex;"><span>                           <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;warning</span>)
</span></span><span style="display:flex;"><span>                          <span style="color:#98c379">&#34;\n\n&#34;</span>))))
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">when</span> (<span style="color:#dcaeea">not</span> (<span style="color:#ef8383">and</span> <span style="color:#dcaeea">latex-available</span> <span style="color:#dcaeea">image-converter</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;path: &#34;</span> (<span style="color:#dcaeea">getenv</span> <span style="color:#98c379">&#34;PATH&#34;</span>) <span style="color:#98c379">&#34;\n\n&#34;</span>)))
</span></span><span style="display:flex;"><span>          <span style="color:#8a93a5;font-style:italic">;; Settings</span>
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;LaTeX preview options&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;outline-2</span>)
</span></span><span style="display:flex;"><span>                  <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          (<span style="color:#ef8383">pcase-dolist</span> (<span style="color:#c7bf54">`</span>(<span style="color:#c7bf54">,</span><span style="color:#dcaeea">var</span> <span style="color:#c7bf54">.</span> <span style="color:#c7bf54">,</span><span style="color:#dcaeea">msg</span>)
</span></span><span style="display:flex;"><span>                         <span style="color:#c7bf54">`</span>((<span style="color:#c7bf54">,</span><span style="color:#dcaeea">org-latex-preview-process-precompiled</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;Precompilation           &#34;</span>)
</span></span><span style="display:flex;"><span>                           (<span style="color:#c7bf54">,</span><span style="color:#dcaeea">org-latex-preview-numbered</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;Equation renumbering     &#34;</span>)
</span></span><span style="display:flex;"><span>                           (<span style="color:#c7bf54">,</span><span style="color:#dcaeea">org-latex-preview-cache</span>  <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;Caching with org-persist &#34;</span>)))
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;• &#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;org-list-dt</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#dcaeea">msg</span>
</span></span><span style="display:flex;"><span>                    (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">var</span>
</span></span><span style="display:flex;"><span>                        (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;ON&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">success</span> <span style="color:#dcaeea">bold</span> <span style="color:#dcaeea">org-block</span>))
</span></span><span style="display:flex;"><span>                      (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;OFF&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#dcaeea">bold</span> <span style="color:#dcaeea">org-block</span>)))
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34;\n&#34;</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;LaTeX preview sizing&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;outline-2</span>) <span style="color:#98c379">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;•&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;org-list-dt</span>)
</span></span><span style="display:flex;"><span>                  <span style="color:#98c379">&#34; Page width  &#34;</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">propertize</span>
</span></span><span style="display:flex;"><span>                   (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%S&#34;</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">org-latex-preview-appearance-options</span> <span style="color:#ef8383">:page-width</span>))
</span></span><span style="display:flex;"><span>                   <span style="color:#56b6c2">&#39;face</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">org-code</span> <span style="color:#dcaeea">org-block</span>))
</span></span><span style="display:flex;"><span>                  <span style="color:#98c379">&#34;   (display equation width in LaTeX)\n&#34;</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;•&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;org-list-dt</span>)
</span></span><span style="display:flex;"><span>                  <span style="color:#98c379">&#34; Scale       &#34;</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">propertize</span>
</span></span><span style="display:flex;"><span>                   (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%.2f&#34;</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">org-latex-preview-appearance-options</span> <span style="color:#ef8383">:scale</span>))
</span></span><span style="display:flex;"><span>                   <span style="color:#56b6c2">&#39;face</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">org-code</span> <span style="color:#dcaeea">org-block</span>))
</span></span><span style="display:flex;"><span>                  <span style="color:#98c379">&#34;  (PNG pixel density multiplier)\n&#34;</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;•&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;org-list-dt</span>)
</span></span><span style="display:flex;"><span>                  <span style="color:#98c379">&#34; Zoom        &#34;</span>
</span></span><span style="display:flex;"><span>                  (<span style="color:#00b1f7">propertize</span>
</span></span><span style="display:flex;"><span>                   (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%.2f&#34;</span> (<span style="color:#00b1f7">plist-get</span> <span style="color:#dcaeea">org-latex-preview-appearance-options</span> <span style="color:#ef8383">:zoom</span>))
</span></span><span style="display:flex;"><span>                   <span style="color:#56b6c2">&#39;face</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">org-code</span> <span style="color:#dcaeea">org-block</span>))
</span></span><span style="display:flex;"><span>                  <span style="color:#98c379">&#34;  (display scaling factor)\n\n&#34;</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;LaTeX preview preamble&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;outline-2</span>) <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">major-mode</span> <span style="color:#56b6c2">&#39;org-mode</span>))
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">point-1</span> (<span style="color:#00b1f7">point</span>)))
</span></span><span style="display:flex;"><span>              (<span style="color:#00b1f7">insert</span> <span style="color:#dcaeea">org-latex-preview-preamble</span> <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>              (<span style="color:#dcaeea">org-src-font-lock-fontify-block</span> <span style="color:#56b6c2">&#39;latex</span> <span style="color:#dcaeea">point-1</span> (<span style="color:#00b1f7">point</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#00b1f7">add-face-text-property</span> <span style="color:#dcaeea">point-1</span> (<span style="color:#00b1f7">point</span>) <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">org-block</span> <span style="color:#ef8383">:height</span> <span style="color:#d19a66">0.9</span>)))
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;\n&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#8a93a5;font-style:italic">;; Diagnostic output</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">insert</span> (<span style="color:#00b1f7">propertize</span> <span style="color:#98c379">&#34;Diagnostic info (copied)&#34;</span> <span style="color:#56b6c2">&#39;face</span> <span style="color:#56b6c2">&#39;outline-2</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#98c379">&#34;\n\n&#34;</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">point-1</span> (<span style="color:#00b1f7">point</span>)))
</span></span><span style="display:flex;"><span>              (<span style="color:#dcaeea">pp</span> <span style="color:#dcaeea">diag</span> (<span style="color:#00b1f7">current-buffer</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#dcaeea">org-src-font-lock-fontify-block</span> <span style="color:#56b6c2">&#39;emacs-lisp</span> <span style="color:#dcaeea">point-1</span> (<span style="color:#00b1f7">point</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#00b1f7">add-face-text-property</span> <span style="color:#dcaeea">point-1</span> (<span style="color:#00b1f7">point</span>) <span style="color:#c7bf54">&#39;</span>(<span style="color:#ef8383">:height</span> <span style="color:#d19a66">0.9</span>))))
</span></span><span style="display:flex;"><span>          (<span style="color:#dcaeea">gui-select-text</span> (<span style="color:#00b1f7">prin1-to-string</span> <span style="color:#dcaeea">diag</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#dcaeea">special-mode</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">setq-local</span>
</span></span><span style="display:flex;"><span>         <span style="color:#dcaeea">revert-buffer-function</span>
</span></span><span style="display:flex;"><span>         (<span style="color:#ef8383">lambda</span> (<span style="color:#c678dd">&amp;rest</span> <span style="color:#dcaeea">_</span>)
</span></span><span style="display:flex;"><span>           (<span style="color:#00b1f7">call-interactively</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-latex-preview-check-health</span>)
</span></span><span style="display:flex;"><span>           (<span style="color:#00b1f7">message</span> <span style="color:#98c379">&#34;Refreshed LaTeX preview diagnostic&#34;</span>)))
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">message-log-max</span> <span style="color:#b756ff;font-weight:bold">nil</span>))
</span></span><span style="display:flex;"><span>          (<span style="color:#dcaeea">toggle-truncate-lines</span> <span style="color:#d19a66">1</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#00b1f7">goto-char</span> (<span style="color:#00b1f7">point-min</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#dcaeea">display-buffer</span> (<span style="color:#00b1f7">current-buffer</span>))))
</span></span><span style="display:flex;"><span>    <span style="color:#dcaeea">diag</span>))</span></span></code></pre></div><h4 id="basic-settings-and-preamble">Basic settings &amp; preamble</h4>
<p>The following are some basic settings for this system, including the latex packages that are supposed to be loaded. Keep in mind that most of this will not work if you don&rsquo;t use the new system mentioned above!</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">use-package!</span> <span style="color:#dcaeea">org-latex-preview</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ef8383">:config</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; Increase preview width &amp; zoom</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">org-latex-preview-appearance-options</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ef8383">:page-width</span> <span style="color:#d19a66">0.8</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">org-latex-preview-appearance-options</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ef8383">:zoom</span> <span style="color:#d19a66">1.2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-packages-alist</span> <span style="color:#c7bf54">&#39;</span>(
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;amsmath&#34;</span> <span style="color:#b756ff;font-weight:bold">t</span> (<span style="color:#98c379">&#34;pdflatex&#34;</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;amssymb&#34;</span> <span style="color:#b756ff;font-weight:bold">t</span> (<span style="color:#98c379">&#34;pdflatex&#34;</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;tikz&#34;</span> <span style="color:#b756ff;font-weight:bold">t</span> (<span style="color:#98c379">&#34;pdflatex&#34;</span> <span style="color:#98c379">&#34;lualatex&#34;</span> <span style="color:#98c379">&#34;xetex&#34;</span>))
</span></span><span style="display:flex;"><span>        (<span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;pgfplots&#34;</span> <span style="color:#b756ff;font-weight:bold">t</span> (<span style="color:#98c379">&#34;pdflatex&#34;</span> <span style="color:#98c379">&#34;lualatex&#34;</span> <span style="color:#98c379">&#34;xetex&#34;</span>))))
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-preview-preamble</span> (<span style="color:#00b1f7">concat</span> <span style="color:#dcaeea">org-latex-preview-preamble</span> <span style="color:#98c379">&#34;\n\\pgfplotsset{compat=1.16}\\usetikzlibrary{cd}&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-compiler</span> <span style="color:#98c379">&#34;pdflatex&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; Use dvisvgm to generate previews</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; You don&#39;t need this, it&#39;s the default:</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-preview-process-default</span> <span style="color:#56b6c2">&#39;dvisvgm</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; Turn on auto-mode, it&#39;s built into Org and much faster/more featured than</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; org-fragtog. (Remember to turn off/uninstall org-fragtog.)</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-mode-hook</span> <span style="color:#56b6c2">&#39;org-latex-preview-auto-mode</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; Block C-n and C-p from opening up previews when using auto-mode</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-latex-preview-auto-ignored-commands</span> <span style="color:#56b6c2">&#39;next-line</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;org-latex-preview-auto-ignored-commands</span> <span style="color:#56b6c2">&#39;previous-line</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; Bonus: Turn on live previews.  This shows you a live preview of a LaTeX</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; fragment and updates the preview in real-time as you edit it.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; To preview only environments, set it to &#39;(block edit-special) instead</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-preview-live</span> <span style="color:#b756ff;font-weight:bold">t</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; More immediate live-previews -- the default delay is 1 second</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-preview-live-debounce</span> <span style="color:#d19a66">0.25</span>))</span></span></code></pre></div><p>While <code>org-latex-preview-auto-mode</code> works pretty great, it doesn&rsquo;t automatically render fragments when I open a new buffer. I want that at least for my roam notes.
Annoyingly, the default method of rendering all previews in a buffer is by running <code>org-latex-preview</code> with a prefix argument (i.e. by pressing <code>C-u</code> before running the function). Let&rsquo;s make explicit functions for it instead.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-latex-preview-clear</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Disable org-latex-preview (which is the same as running org-latex-preview with prefix argument)&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">current-prefix-arg</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#d19a66">4</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">call-interactively</span> <span style="color:#56b6c2">&#39;org-latex-preview</span>)))
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-latex-preview-whole-buffer</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Render all previews in buffer (which is the same as running org-latex-preview with a double prefix argument)&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">current-prefix-arg</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#d19a66">16</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">call-interactively</span> <span style="color:#56b6c2">&#39;org-latex-preview</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;roam-pseudohook</span> <span style="color:#56b6c2">&#39;org-latex-preview-whole-buffer</span>)</span></span></code></pre></div><h4 id="settings-necessary-for-tikz--disabled">Settings necessary for TikZ (DISABLED)</h4>
<p>Not necessary since I now use svg rendering</p>
<p>There is two ways of rendering inline LaTeX previews: <code>dvipng</code> and <code>imagemagick</code>.
TikZ (and in particular <code>tikzcd</code>) don&rsquo;t like <code>dvipng</code> somehow. So let&rsquo;s switch over to the magicks:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">org</span> (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-create-formula-image-program</span> <span style="color:#56b6c2">&#39;imagemagick</span>))</span></span></code></pre></div><p>For this to work however, <code>imagemagick</code> needs some further customization outside of Emacs (see <a href="https://stackoverflow.com/a/59193253" target="_blank">here</a>).</p>
<h4 id="org-fragtog--disabled">org-fragtog (DISABLED)</h4>
<p>The <code>org-fragtog</code> package then enables automatically switching between LaTeX-preview and its underlying code. It is not necessary with the new fancy preview system, but I&rsquo;ll keep the code here for now.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">org</span> (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-startup-with-latex-preview</span> <span style="color:#b756ff;font-weight:bold">t</span>))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">use-package!</span> <span style="color:#dcaeea">org-fragtog</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">org</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:hook</span> (<span style="color:#dcaeea">org-mode</span> <span style="color:#c7bf54">.</span> <span style="color:#dcaeea">org-fragtog-mode</span>) <span style="color:#8a93a5;font-style:italic">; this auto-enables it when you enter an org-buffer</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:config</span>
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div><h4 id="correct-backgrounds">Correct Backgrounds</h4>
<p>The following makes sure the backgrounds of LaTeX fragments (or their surroundings) don&rsquo;t look bad (cf. <a href="https://tecosaur.github.io/emacs-config/config.html#prettier-highlighting" target="_blank">tecosaur</a>)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">require</span> <span style="color:#56b6c2">&#39;org-src</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-to-list</span> <span style="color:#56b6c2">&#39;org-src-block-faces</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;latex&#34;</span> (<span style="color:#ef8383">:inherit</span> <span style="color:#dcaeea">default</span> <span style="color:#ef8383">:extend</span> <span style="color:#b756ff;font-weight:bold">t</span>)))</span></span></code></pre></div><h4 id="automatically-update-size--disabled">Automatically Update Size (DISABLED)</h4>
<p>I made my own primitive system for this before getting the new fancy preview system, which does this much better. I&rsquo;ll still keep the code and text here for now though.</p>
<p>The size of LaTeX fragments does not automatically update when the font size is changed. This fixes that.
It turned out to not be so easy though for an elisp noob like me, so here are some notes:</p>
<ul>
<li>Annoyingly, disabling LaTeX previews is achieved by running <code>org-latex-preview</code> with <em>prefix argument</em>, i.e. by pressing <code>C-u</code> before running the function. Calling this from a script is a bit of a hassle. This is what happens in <code>org-latex-preview-clear</code>.</li>
<li>I want to check whether writeroom-mode is active. This is done by checking the <code>writeroom-mode</code> variable. However, this variable is at the same time the function that toggles the mode. So <code>bound-and-true-p</code> is used to only check the variable and not call the function. (analogously for big-font-mode)</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-default-scale</span> <span style="color:#d19a66">1.5</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-writeroom-scale</span> <span style="color:#d19a66">2.5</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-latex-big-font-scale</span> <span style="color:#d19a66">2.5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-latex-preview-clear</span> ()
</span></span><span style="display:flex;"><span>  <span style="color:#98c379">&#34;Disable org-latex-preview (which is the same as running org-latex-preview with prefix argument)&#34;</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">let</span> ((<span style="color:#dcaeea">current-prefix-arg</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#d19a66">4</span>)))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">call-interactively</span> <span style="color:#56b6c2">&#39;org-latex-preview</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">latex-preview-rescale</span> ()
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">cond</span> ((<span style="color:#dcaeea">bound-and-true-p</span> <span style="color:#dcaeea">writeroom-mode</span>) (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-format-latex-options</span> (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">org-format-latex-options</span> <span style="color:#ef8383">:scale</span> <span style="color:#dcaeea">org-latex-writeroom-scale</span>)))
</span></span><span style="display:flex;"><span>        ((<span style="color:#dcaeea">bound-and-true-p</span> <span style="color:#dcaeea">doom-big-font-mode</span>) (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-format-latex-options</span> (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">org-format-latex-options</span> <span style="color:#ef8383">:scale</span> <span style="color:#dcaeea">org-latex-big-font-scale</span>)))
</span></span><span style="display:flex;"><span>        (<span style="color:#b756ff;font-weight:bold">t</span> (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-format-latex-options</span> (<span style="color:#00b1f7">plist-put</span> <span style="color:#dcaeea">org-format-latex-options</span> <span style="color:#ef8383">:scale</span> <span style="color:#dcaeea">org-latex-default-scale</span>)))
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>  <span style="color:#8a93a5;font-style:italic">;; re-render LaTeX fragments</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-latex-preview-clear</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">org-latex-preview</span>)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;writeroom-mode-hook</span> <span style="color:#56b6c2">&#39;latex-preview-rescale</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;doom-big-font-mode-hook</span> <span style="color:#56b6c2">&#39;latex-preview-rescale</span>)</span></span></code></pre></div><h4 id="smartparens">Smartparens</h4>
<p>I want Smartparens to also recognize typical LaTeX-patterns in org-mode (cf. <a href="https://emacs.stackexchange.com/a/56094" target="_blank">stackexchange</a>).</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">require</span> <span style="color:#56b6c2">&#39;smartparens-config</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;\\[&#34;</span> <span style="color:#98c379">&#34;\\]&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;$&#34;</span> <span style="color:#98c379">&#34;$&#34;</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;&#39;&#34;</span> <span style="color:#98c379">&#34;&#39;&#34;</span> <span style="color:#ef8383">:actions</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">rem</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;=&#34;</span> <span style="color:#98c379">&#34;=&#34;</span> <span style="color:#ef8383">:actions</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">rem</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;\\left(&#34;</span> <span style="color:#98c379">&#34;\\right)&#34;</span> <span style="color:#ef8383">:trigger</span> <span style="color:#98c379">&#34;\\l(&#34;</span> <span style="color:#ef8383">:post-handlers</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">sp-latex-insert-spaces-inside-pair</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;\\left[&#34;</span> <span style="color:#98c379">&#34;\\right]&#34;</span> <span style="color:#ef8383">:trigger</span> <span style="color:#98c379">&#34;\\l[&#34;</span> <span style="color:#ef8383">:post-handlers</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">sp-latex-insert-spaces-inside-pair</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;\\left\\{&#34;</span> <span style="color:#98c379">&#34;\\right\\}&#34;</span> <span style="color:#ef8383">:trigger</span> <span style="color:#98c379">&#34;\\l{&#34;</span> <span style="color:#ef8383">:post-handlers</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">sp-latex-insert-spaces-inside-pair</span>))
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">sp-local-pair</span> <span style="color:#56b6c2">&#39;org-mode</span> <span style="color:#98c379">&#34;\\left|&#34;</span> <span style="color:#98c379">&#34;\\right|&#34;</span> <span style="color:#ef8383">:trigger</span> <span style="color:#98c379">&#34;\\l|&#34;</span> <span style="color:#ef8383">:post-handlers</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">sp-latex-insert-spaces-inside-pair</span>))</span></span></code></pre></div><h3 id="xournal-plus-plus-integration--org-notebook">Xournal++ integration (&ldquo;Org Notebook&rdquo;)</h3>
<p>I take handwritten notes using <a href="https://github.com/xournalpp/xournalpp" target="_blank">Xournal++</a>. Being able to integrate those into org files sounds great, especially for hand-drawn diagrams.
There exists a package for this called <a href="https://gitlab.com/vherrmann/org-xournalpp" target="_blank">org-xournalpp</a>, but the following <a href="https://www.reddit.com/r/orgmode/comments/egasgy/comment/fc5molm/" target="_blank">code snippet I found on reddit</a> works better for my use case. Why? Because it directly links images into the org document, which also works with <code>org-roam-ui</code>.
I modified the snippet slightly to also work in files without headings, work with a template, and export with transparent background.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;; Org Notebook</span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-notebook-result-dir</span> <span style="color:#98c379">&#34;./handwritten/&#34;</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">org-notebook-template-path</span> <span style="color:#98c379">&#34;~/Dropbox/template.xopp&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-notebook-get-png-link-at-point</span> (<span style="color:#dcaeea">shouldThrowError</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;Returns filepath of org link at cursor&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">linestr</span> (<span style="color:#dcaeea">thing-at-point</span> <span style="color:#56b6c2">&#39;line</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">start</span> (<span style="color:#00b1f7">string-match</span> <span style="color:#98c379">&#34;\\[\\[&#34;</span> <span style="color:#dcaeea">linestr</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">end</span> (<span style="color:#00b1f7">string-match</span> <span style="color:#98c379">&#34;\\]\\]&#34;</span> <span style="color:#dcaeea">linestr</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">shouldThrowError</span> (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">start</span> <span style="color:#b756ff;font-weight:bold">nil</span> (<span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#98c379">&#34;No link found&#34;</span>)) <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">shouldThrowError</span> (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">end</span> <span style="color:#b756ff;font-weight:bold">nil</span>   (<span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#98c379">&#34;No link found&#34;</span>)) <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> <span style="color:#dcaeea">shouldThrowError</span> (<span style="color:#ef8383">if</span> (<span style="color:#00b1f7">string-match</span> <span style="color:#98c379">&#34;.png&#34;</span> <span style="color:#dcaeea">linestr</span>) <span style="color:#b756ff;font-weight:bold">nil</span>   (<span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#98c379">&#34;Link is not an image&#34;</span>)) <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> (<span style="color:#ef8383">and</span> <span style="color:#dcaeea">linestr</span> <span style="color:#dcaeea">start</span> <span style="color:#dcaeea">end</span>) (<span style="color:#00b1f7">substring</span> <span style="color:#dcaeea">linestr</span> (<span style="color:#00b1f7">+</span> <span style="color:#dcaeea">start</span> <span style="color:#d19a66">2</span>) <span style="color:#dcaeea">end</span>) <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-notebook-gen-filename-at-point</span> ()
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;Returns a list of valid file paths corresponding to current context(Header &amp; Date).&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">unless</span> (<span style="color:#00b1f7">file-directory-p</span> <span style="color:#dcaeea">org-notebook-result-dir</span>) (<span style="color:#dcaeea">make-directory</span> <span style="color:#dcaeea">org-notebook-result-dir</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">date-string</span> (<span style="color:#00b1f7">format-time-string</span> <span style="color:#98c379">&#34;%Y-%m-%d_%H%M%S&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">; return current heading if available</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">; otherwise return title of org document</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">; if that&#39;s also not available, return nil</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">heading</span> (<span style="color:#ef8383">condition-case</span> <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>            (<span style="color:#00b1f7">nth</span> <span style="color:#d19a66">4</span> (<span style="color:#dcaeea">org-heading-components</span>))
</span></span><span style="display:flex;"><span>            (<span style="color:#fd7474;font-weight:bold">error</span> (<span style="color:#ef8383">if</span> (<span style="color:#dcaeea">org-collect-keywords</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;TITLE&#34;</span>))
</span></span><span style="display:flex;"><span>                (<span style="color:#00b1f7">nth</span> <span style="color:#d19a66">1</span> (<span style="color:#00b1f7">nth</span> <span style="color:#d19a66">0</span> (<span style="color:#dcaeea">org-collect-keywords</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#98c379">&#34;TITLE&#34;</span>))))
</span></span><span style="display:flex;"><span>                <span style="color:#98c379">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            ))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">heading</span> (<span style="color:#dcaeea">replace-regexp-in-string</span> <span style="color:#98c379">&#34;\\[.*\\]&#34;</span> <span style="color:#98c379">&#34;&#34;</span> <span style="color:#dcaeea">heading</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; First filter out weird symbols</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">heading</span> (<span style="color:#dcaeea">replace-regexp-in-string</span> <span style="color:#98c379">&#34;[/;:&#39;\&#34;\(\)]+&#34;</span> <span style="color:#98c379">&#34;&#34;</span> <span style="color:#dcaeea">heading</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">heading</span> (<span style="color:#dcaeea">string-trim</span> <span style="color:#dcaeea">heading</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; filter out swedish characters åäö -&gt; aao</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">heading</span>(<span style="color:#dcaeea">replace-regexp-in-string</span> <span style="color:#98c379">&#34;[åÅäÄ]+&#34;</span> <span style="color:#98c379">&#34;a&#34;</span> <span style="color:#dcaeea">heading</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">heading</span>(<span style="color:#dcaeea">replace-regexp-in-string</span> <span style="color:#98c379">&#34;[öÓ]+&#34;</span> <span style="color:#98c379">&#34;o&#34;</span> <span style="color:#dcaeea">heading</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#8a93a5;font-style:italic">;; whitespace and . to underscores</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">heading</span> (<span style="color:#dcaeea">replace-regexp-in-string</span> <span style="color:#98c379">&#34;[ .]+&#34;</span> <span style="color:#98c379">&#34;_&#34;</span> <span style="color:#dcaeea">heading</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">filename</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%s-%s&#34;</span> <span style="color:#dcaeea">heading</span> <span style="color:#dcaeea">date-string</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">filename</span> (<span style="color:#dcaeea">read-minibuffer</span> <span style="color:#98c379">&#34;Filename: &#34;</span> <span style="color:#dcaeea">filename</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">image-path</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%s%s.png&#34;</span> <span style="color:#dcaeea">org-notebook-result-dir</span> <span style="color:#dcaeea">filename</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">xournal-path</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;%s%s.xopp&#34;</span> <span style="color:#dcaeea">org-notebook-result-dir</span> <span style="color:#dcaeea">filename</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">list</span> <span style="color:#dcaeea">image-path</span> <span style="color:#dcaeea">xournal-path</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-notebook-create-xournal</span> ()
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;Insert an image and open the drawing program&#34;</span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">notebookfile</span> (<span style="color:#dcaeea">org-notebook-gen-filename-at-point</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">image-path</span> (<span style="color:#00b1f7">car</span> <span style="color:#dcaeea">notebookfile</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">xournal-path</span> (<span style="color:#00b1f7">nth</span> <span style="color:#d19a66">1</span> <span style="color:#dcaeea">notebookfile</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">evil-open-below</span> <span style="color:#d19a66">1</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;[[&#34;</span> <span style="color:#dcaeea">image-path</span> <span style="color:#98c379">&#34;]]\n&#34;</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">evil-normal-state</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">start-process-shell-command</span> <span style="color:#98c379">&#34;org-notebook-copy-template&#34;</span> <span style="color:#b756ff;font-weight:bold">nil</span> (<span style="color:#00b1f7">concat</span> <span style="color:#98c379">&#34;cp &#34;</span> <span style="color:#dcaeea">org-notebook-template-path</span> <span style="color:#98c379">&#34; &#34;</span> <span style="color:#dcaeea">xournal-path</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">start-process</span> <span style="color:#98c379">&#34;org-notebook-drawing&#34;</span> <span style="color:#b756ff;font-weight:bold">nil</span> <span style="color:#98c379">&#34;xournalpp&#34;</span> <span style="color:#dcaeea">xournal-path</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-notebook-edit-xournal</span> ()
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">image-path</span> (<span style="color:#dcaeea">org-notebook-get-png-link-at-point</span> <span style="color:#b756ff;font-weight:bold">nil</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> (<span style="color:#dcaeea">not</span> <span style="color:#dcaeea">image-path</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">if</span> (<span style="color:#dcaeea">y-or-n-p</span> <span style="color:#98c379">&#34;No matching xournal file, create one?&#34;</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#dcaeea">org-notebook-create-xournal</span>)
</span></span><span style="display:flex;"><span>            (<span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#98c379">&#34;Nothing more to do...&#34;</span>)
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>            <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">xournal-path</span> (<span style="color:#dcaeea">replace-regexp-in-string</span> <span style="color:#98c379">&#34;\.png&#34;</span> <span style="color:#98c379">&#34;.xopp&#34;</span> <span style="color:#dcaeea">image-path</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> (<span style="color:#00b1f7">file-readable-p</span> <span style="color:#dcaeea">xournal-path</span>) (<span style="color:#00b1f7">start-process</span> <span style="color:#98c379">&#34;org-notebook-drawing&#34;</span> <span style="color:#b756ff;font-weight:bold">nil</span> <span style="color:#98c379">&#34;xournalpp&#34;</span> <span style="color:#dcaeea">xournal-path</span>) (<span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#98c379">&#34;No matching xournal file found&#34;</span>))
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">org-notebook-generate-xournal-image</span> ()
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">image-path</span> (<span style="color:#dcaeea">org-notebook-get-png-link-at-point</span> <span style="color:#b756ff;font-weight:bold">t</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">xournal-path</span> (<span style="color:#dcaeea">replace-regexp-in-string</span> <span style="color:#98c379">&#34;\.png&#34;</span> <span style="color:#98c379">&#34;.xopp&#34;</span> <span style="color:#dcaeea">image-path</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">if</span> (<span style="color:#00b1f7">file-readable-p</span> <span style="color:#dcaeea">xournal-path</span>) <span style="color:#b756ff;font-weight:bold">nil</span> (<span style="color:#fd7474;font-weight:bold">error</span> <span style="color:#98c379">&#34;No matching xournal file found&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">xournal_cmd</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;xournalpp --export-no-background %s %s %s&#34;</span> <span style="color:#dcaeea">xournal-path</span> <span style="color:#98c379">&#34;-i&#34;</span> <span style="color:#dcaeea">image-path</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">print</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;Generating image file: %s&#34;</span> <span style="color:#dcaeea">xournal_cmd</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">shell-command</span> <span style="color:#dcaeea">xournal_cmd</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">convert_cmd</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;convert %s -trim -bordercolor none -border 20 +repage %s&#34;</span> <span style="color:#dcaeea">image-path</span> <span style="color:#dcaeea">image-path</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#00b1f7">print</span> (<span style="color:#00b1f7">format</span> <span style="color:#98c379">&#34;Auto cropping image: %s&#34;</span> <span style="color:#dcaeea">convert_cmd</span>))
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">shell-command</span> <span style="color:#dcaeea">convert_cmd</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    (<span style="color:#dcaeea">org-redisplay-inline-images</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">org</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">org-mode-map</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:localleader</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;x&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;Xournal&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;x&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-notebook-create-xournal</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;g&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-notebook-generate-xournal-image</span>
</span></span><span style="display:flex;"><span>    <span style="color:#98c379">&#34;e&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-notebook-edit-xournal</span>)</span></span></code></pre></div><h3 id="org-d20">org-d20</h3>
<p>Org mode is really nice for tabletop RPGs, both taking notes as a player, as well as for writing your campaign as a game master.
The <a href="https://github.com/spwhitton/org-d20" target="_blank">org-d20</a> minor mode allows for rolling dice and taking care of combat initiative and hp within org.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:localleader</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">org-mode-map</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;D&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;org-d20&#34;</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;start/advance combat&#34;</span> <span style="color:#98c379">&#34;i&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-d20-initiative-dwim</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;add to combat&#34;</span> <span style="color:#98c379">&#34;a&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-d20-initiative-add</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;apply damage at point&#34;</span> <span style="color:#98c379">&#34;d&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-d20-damage</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;roll&#34;</span> <span style="color:#98c379">&#34;r&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">org-d20-roll</span>
</span></span><span style="display:flex;"><span>       )
</span></span><span style="display:flex;"><span>      )</span></span></code></pre></div><h2 id="latex">LaTeX</h2>
<h3 id="fixing-defaults">&ldquo;Fixing&rdquo; defaults</h3>
<p>There are a couple of things that I, a person who learned LaTeX long before emacs, find quite annoying in how Doom is setup do deal with LaTeX by default.
These changes make everything feel more intuitive to me.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;(setq +latex-viewers nil)</span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">+latex-indent-item-continuation-offset</span> <span style="color:#56b6c2">&#39;auto</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">evil-tex-toggle-override-m</span> <span style="color:#b756ff;font-weight:bold">nil</span>) <span style="color:#8a93a5;font-style:italic">;; I want to use m for &#34;move&#34; (evil-cut)</span>
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;... so I map toggle keybindings to localleader instead</span>
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:localleader</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">evil-tex-mode-map</span>
</span></span><span style="display:flex;"><span>      (<span style="color:#ef8383">:prefix</span> (<span style="color:#98c379">&#34;t&#34;</span> <span style="color:#c7bf54">.</span> <span style="color:#98c379">&#34;toggle&#34;</span>) <span style="color:#8a93a5;font-style:italic">;; TODO this is not displaying descriptions properly, probably related to https://github.com/hlissner/doom-emacs/issues/4288</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;command&#34;</span>          <span style="color:#98c379">&#34;c&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">evil-tex-toggle-command</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;delimiter&#34;</span>        <span style="color:#98c379">&#34;d&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">evil-tex-toggle-delim</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;environment&#34;</span>      <span style="color:#98c379">&#34;e&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">evil-tex-toggle-env</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;math&#34;</span>             <span style="color:#98c379">&#34;m&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">evil-tex-toggle-math</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;math align*&#34;</span>      <span style="color:#98c379">&#34;M&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">evil-tex-toggle-math-align</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;section&#34;</span>          <span style="color:#98c379">&#34;S&#34;</span>     <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">evil-tex-toggle-section</span>
</span></span><span style="display:flex;"><span>       )
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span><span style="color:#8a93a5;font-style:italic">;;</span></span></span></code></pre></div><p>The following turns of all flycheck-warnings in AUCTex, since for the most part I just find them annoying.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">flycheck-global-modes</span> <span style="color:#c7bf54">&#39;</span>(<span style="color:#dcaeea">not</span> <span style="color:#dcaeea">LaTeX-mode</span> <span style="color:#dcaeea">latex-mode</span>))</span></span></code></pre></div><p>Unfortunately rainbow delimiters break frequently in LaTeX (because of &ldquo;mismatched&rdquo; delimiters in open intervals like <code>]a,b[</code> but also randomly at other times). Best to disable them.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;TeX-mode-hook</span> <span style="color:#56b6c2">&#39;rainbow-delimiters-mode-disable</span>
</span></span><span style="display:flex;"><span>          <span style="color:#56b6c2">&#39;LaTeX-mode-hook</span> <span style="color:#56b6c2">&#39;rainbow-delimiters-mode-disable</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">latex</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#dcaeea">remove-hook</span> <span style="color:#56b6c2">&#39;TeX-update-style-hook</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">rainbow-delimiters-mode</span>))</span></span></code></pre></div><p>Better shortcut for showing TeX-errors (backtick is very annoying on a German keyboard).</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:localleader</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">evil-tex-mode-map</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ef8383">:desc</span> <span style="color:#98c379">&#34;TeX-next-error&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;e&#34;</span> <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">TeX-next-error</span>)</span></span></code></pre></div><p>Another annoyance: I don&rsquo;t like it when AUCTex interferes with my quotation marks.
Removing this AUCTex-feature is reasonably simple and can either be done through the <code>TeX-quote-after-quote</code>-variable, or by just un-mapping <code>TeX-insert-quote</code> from the quotation mark key.
However, for whatever reason this same feature was also implemented in <code>smartparens</code>, specifically <code>smartparens-latex.el</code>. And removing this is <em>really</em> a nightmare. None of the solutions I found online worked for me (see <a href="https://github.com/doomemacs/doomemacs/issues/1688" target="_blank">here</a>, <a href="https://github.com/doomemacs/doomemacs/issues/485" target="_blank">here</a>, <a href="https://github.com/Fuco1/smartparens/issues/1100" target="_blank">here</a>, <a href="https://emacs.stackexchange.com/questions/34035/how-to-make-smartparens-insert-and-instead-of-in-latex-modes" target="_blank">here</a>, <a href="https://emacs.stackexchange.com/questions/31166/smartparens-not-insert-pair-of-latex-quotes?rq=1" target="_blank">here</a>, <a href="https://github.com/Fuco1/smartparens/issues/983" target="_blank">here</a>, and <a href="https://emacs.stackexchange.com/questions/52233/disable-tex-modes-auto-tex-insert-quote-functionaliy" target="_blank">here</a>&hellip;).
So instead, after like 3 hours of trial and error, I&rsquo;m settling for this hack.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">TeX-quote-after-quote</span> <span style="color:#b756ff;font-weight:bold">t</span>) <span style="color:#8a93a5;font-style:italic">; how this is supposed to work, for good measure</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">defun</span> <span style="color:#dcaeea">insert-standard-quote</span> ()
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">&#34;insert a completely normal quotation mark, bypassing weird AUCTex-defaults&#34;</span>
</span></span><span style="display:flex;"><span>        (<span style="color:#ef8383">interactive</span>)
</span></span><span style="display:flex;"><span>        (<span style="color:#00b1f7">insert</span> <span style="color:#98c379">&#34;\&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">tex</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">tex-mode-map</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\&#34;&#34;</span> <span style="color:#56b6c2">&#39;insert-standard-quote</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">tex</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">LaTeX-mode-map</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\&#34;&#34;</span> <span style="color:#56b6c2">&#39;insert-standard-quote</span>)</span></span></code></pre></div><h3 id="appearance">Appearance</h3>
<p>Long lines are hard to read. This activates a maximum line length in TeX-buffers.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">add-hook</span> <span style="color:#56b6c2">&#39;TeX-mode-hook</span> <span style="color:#56b6c2">&#39;window-margin-mode</span>)</span></span></code></pre></div><h3 id="cdlatex">CDLaTeX</h3>
<p>This mode provides pretty useful shortcuts for writing math. I ignored this package for too long, probably cause the default keybindings really don&rsquo;t work with me.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:after</span> <span style="color:#dcaeea">latex</span> <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">cdlatex-mode-map</span>
</span></span><span style="display:flex;"><span>      <span style="color:#8a93a5;font-style:italic">; I&#39;m too used to using the &#39; key to type stuff like &#34;f prime&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\&#39;&#34;</span>      <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>      <span style="color:#8a93a5;font-style:italic">; so this key is better imo</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\´&#34;</span>       <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">cdlatex-math-modify</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\`&#34;</span>       <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">cdlatex-math-symbol</span>
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>(<span style="color:#dcaeea">map!</span> <span style="color:#ef8383">:map</span> <span style="color:#dcaeea">org-cdlatex-mode-map</span>     <span style="color:#8a93a5;font-style:italic">; same thing for within org mode</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\&#39;&#34;</span>      <span style="color:#b756ff;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\´&#34;</span>       <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">cdlatex-math-modify</span>
</span></span><span style="display:flex;"><span>      <span style="color:#98c379">&#34;\`&#34;</span>       <span style="color:#00b1f7">#&#39;</span><span style="color:#dcaeea">cdlatex-math-symbol</span>
</span></span><span style="display:flex;"><span>      )</span></span></code></pre></div><p>The internal variables also need to be changed, or otherwise the old keys will still be active in the CDLaTeX menu.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#ef8383">require</span> <span style="color:#56b6c2">&#39;cdlatex</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">cdlatex-math-modify-prefix</span> <span style="color:#d19a66">180</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">cdlatex-math-symbol-prefix</span> <span style="color:#d19a66">96</span>)</span></span></code></pre></div><p>Let&rsquo;s also add a few more symbols/modifiers. (cf. <a href="https://tecosaur.github.io/emacs-config/config.html#math-input-cdlatex" target="_blank">tecosaur</a>)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>(<span style="color:#dcaeea">after!</span> <span style="color:#dcaeea">cdlatex</span>
</span></span><span style="display:flex;"><span>  (<span style="color:#ef8383">setq</span> <span style="color:#dcaeea">cdlatex-math-symbol-alist</span>
</span></span><span style="display:flex;"><span>   <span style="color:#c7bf54">&#39;</span>( <span style="color:#8a93a5;font-style:italic">;; adding missing functions to 3rd level symbols</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?_</span>    (<span style="color:#98c379">&#34;\\downarrow&#34;</span> <span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;\\inf&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?2</span>    (<span style="color:#98c379">&#34;^2&#34;</span> <span style="color:#98c379">&#34;\\sqrt{?}&#34;</span> <span style="color:#98c379">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?3</span>    (<span style="color:#98c379">&#34;^3&#34;</span> <span style="color:#98c379">&#34;\\sqrt[3]{?}&#34;</span> <span style="color:#98c379">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?^</span>    (<span style="color:#98c379">&#34;\\uparrow&#34;</span> <span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;\\sup&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?k</span>    (<span style="color:#98c379">&#34;\\kappa&#34;</span> <span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;\\ker&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?m</span>    (<span style="color:#98c379">&#34;\\mu&#34;</span> <span style="color:#98c379">&#34;&#34;</span> <span style="color:#98c379">&#34;\\lim&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?c</span>    (<span style="color:#98c379">&#34;&#34;</span>   <span style="color:#98c379">&#34;\\circ&#34;</span> <span style="color:#98c379">&#34;\\cos&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?d</span>    (<span style="color:#98c379">&#34;\\delta&#34;</span> <span style="color:#98c379">&#34;\\partial&#34;</span> <span style="color:#98c379">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?D</span>    (<span style="color:#98c379">&#34;\\Delta&#34;</span> <span style="color:#98c379">&#34;\\nabla&#34;</span> <span style="color:#98c379">&#34;\\deg&#34;</span>))
</span></span><span style="display:flex;"><span>     <span style="color:#8a93a5;font-style:italic">;; no idea why \Phi isnt on &#39;F&#39; in first place, \phi is on &#39;f&#39;.</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?F</span>    (<span style="color:#98c379">&#34;\\Phi&#34;</span>))
</span></span><span style="display:flex;"><span>     <span style="color:#8a93a5;font-style:italic">;; now just convenience</span>
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?.</span>    (<span style="color:#98c379">&#34;\\cdot&#34;</span> <span style="color:#98c379">&#34;\\dots&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?:</span>    (<span style="color:#98c379">&#34;\\vdots&#34;</span> <span style="color:#98c379">&#34;\\ddots&#34;</span>))
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?*</span>    (<span style="color:#98c379">&#34;\\times&#34;</span> <span style="color:#98c379">&#34;\\star&#34;</span> <span style="color:#98c379">&#34;\\ast&#34;</span>)))
</span></span><span style="display:flex;"><span>   <span style="color:#dcaeea">cdlatex-math-modify-alist</span>
</span></span><span style="display:flex;"><span>   <span style="color:#c7bf54">&#39;</span>((<span style="color:#98c379">?B</span>    <span style="color:#98c379">&#34;\\mathbb&#34;</span>        <span style="color:#b756ff;font-weight:bold">nil</span>          <span style="color:#b756ff;font-weight:bold">t</span>    <span style="color:#b756ff;font-weight:bold">nil</span>  <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?o</span>    <span style="color:#98c379">&#34;\\operatorname&#34;</span>  <span style="color:#b756ff;font-weight:bold">nil</span>          <span style="color:#b756ff;font-weight:bold">t</span>    <span style="color:#b756ff;font-weight:bold">nil</span>  <span style="color:#b756ff;font-weight:bold">nil</span>)
</span></span><span style="display:flex;"><span>     (<span style="color:#98c379">?a</span>    <span style="color:#98c379">&#34;\\abs&#34;</span>           <span style="color:#b756ff;font-weight:bold">nil</span>          <span style="color:#b756ff;font-weight:bold">t</span>    <span style="color:#b756ff;font-weight:bold">nil</span>  <span style="color:#b756ff;font-weight:bold">nil</span>))))</span></span></code></pre></div><h2 id="tangle-this-file">Tangle this file!</h2>
<p>Tangle on save? Reload after tangle? These hooks will ask you after every save.</p>
<p>;; Local Variables:
;; eval: (add-hook &lsquo;after-save-hook (lambda ()(if (y-or-n-p &ldquo;Reload?&rdquo;)(doom/reload))) nil t)
;; eval: (add-hook &lsquo;after-save-hook (lambda ()(if (y-or-n-p &ldquo;Tangle?&rdquo;)(org-babel-tangle))) nil t)
;; End:</p>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<a id="logo" href="https://freakybyte.github.io/dotfiles/"><img src="https://freakybyte.github.io/dotfiles/images/logo.png"></a>

        </div>
        <div class="searchbox default-animation">
          <i class="fas fa-search" title="Search (CTRL+ALT+f)"></i>
          <label class="a11y-only" for="R-search-by">Search</label>
          <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
          <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
        </div>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="https://freakybyte.github.io/dotfiles/js/auto-complete.js?1712182173" defer></script>
        <script src="https://freakybyte.github.io/dotfiles/js/lunr/lunr.min.js?1712182173" defer></script>
        <script src="https://freakybyte.github.io/dotfiles/js/lunr/lunr.stemmer.support.min.js?1712182173" defer></script>
        <script src="https://freakybyte.github.io/dotfiles/js/lunr/lunr.multi.min.js?1712182173" defer></script>
        <script src="https://freakybyte.github.io/dotfiles/js/lunr/lunr.en.min.js?1712182173" defer></script>
        <script src="https://freakybyte.github.io/dotfiles/js/search.js?1712182173" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-topics">
          <ul class="enlarge morespace collapsible-menu">
          <li data-nav-id="/emacs/index.html" class="active"><a class="padding" href="https://freakybyte.github.io/dotfiles/emacs/index.html">DOOM Emacs Config</a></li>
          <li data-nav-id="/qtile/index.html" class=""><a class="padding" href="https://freakybyte.github.io/dotfiles/qtile/index.html">Qtile Config</a></li>
          </ul>
        </div>
        <div id="R-shortcuts">
          <div class="nav-title padding"></div>
          <ul class="space">
            <li><a class="padding" href="https://github.com/FreakyByte/dotfiles"><i class='fa-fw fab fa-github'></i> GitHub repo</a></li>
          </ul>
        </div>
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="https://freakybyte.github.io/dotfiles/emacs/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-my-custom-variant" value="my-custom-variant" selected>My Custom Variant</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">
	    <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          </div>
        </div>
      </div>
    </aside>
    <script src="https://freakybyte.github.io/dotfiles/js/clipboard.min.js?1712182173" defer></script>
    <script src="https://freakybyte.github.io/dotfiles/js/perfect-scrollbar.min.js?1712182173" defer></script>
    <script src="https://freakybyte.github.io/dotfiles/js/theme.js?1712182173" defer></script>
  </body>
</html>
